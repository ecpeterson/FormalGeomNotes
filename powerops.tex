% -*- root: main.tex -*-



\chapter{Power Operations}\label{PowerOpnsChapter}

\begin{center}
\textbf{Convention: We will write \(E\) for \(E_\Gamma\), \(\Gamma\) a fixed formal group of finite height, for the entirety of this Appendix.}
\end{center}

Our goal in this Appendix is to give a tour of the interaction of the \(\sigma\)--orientation with a topic of modern research, the theory of \index{E infty ring spectrum@\(E_\infty\)--ring spectrum}\(E_\infty\)--ring spectra, in a manner consistent with the rest of the topics in this book.  Because the theory of \(E_\infty\)--ring spectra (in particular: their algebraic geometry) is still very much developing, we have no hope of stating results in their maximum strength or giving a completely clear picture---as of this writing, the maximum strength is unknown and the picture is still resolving.  Although \(E_\infty\)--ring spectra themselves were introduced decades ago, we will even avoid giving a proper definition of them here, instead referring to the original work of May and collaborators~\cite{EKMM} and the more recent work of Lurie~\cite[Chapter 7]{LurieHA} for a proper treatment.  In acknowledgement of this underwhelming level of rigor, we have downgraded our discussion from a Case Study to an Appendix.\footnote{Additionally, the contents of this Appendix did not make it into the classroom version of this course, though the latter two sections did appear as contributed talks to graduate student seminars.}

As far as we are concerned, \(E_\infty\)--ring spectra arise in order to solve the following problem: given two ring spectra \(R\) and \(S\) in the homotopy category, the set of homotopy classes of ring maps \(\CatOf{RingSpectra}(R, S)\) forms a subset of the set of all homotopy classes \([R, S] = \pi_0 \CatOf{Spectra}(R, S)\), selected by a homomorphism condition.  There is no meaningful way to enrich this to a \emph{space} of ring spectrum maps from \(R\) to \(S\), which inhibits us from understanding an obstruction theory for ring spectra, i.e., approximating \(R\) by ``nearby'' ring spectra \(R'\) in a way that relates \(\CatOf{RingSpectra}(R, S)\) and \(\CatOf{RingSpectra}(R', S)\) by a fiber sequence.\index{obstruction theory}

The extra data that accomplishes this mapping space feat turns out to be an explicit naming of the homotopies controlling the associativity and commutativity of the ring spectrum multiplication, which are subject to highly intricate compatibility conditions.\footnote{This is rather analogous to the extra data required on a \emph{space}, beyond just a multiplication, which allows one to use the bar construction to assemble a delooping.}\footnote{The high degree of intricacy accomplishes this goal of constructing mapping spaces, but it interacts strangely with the classical notion of a ring spectrum in the homotopy category: there are ring spectrum maps that admit \emph{no} enrichment to an \(E_\infty\) map, and there are ring spectrum maps that admit \emph{multiple} enrichments to \(E_\infty\) maps.}  Again, rather than spell this out, it suffices for our purposes to say that there is such a notion of a structured ring spectrum that begets a mapping space between two such.  We also record the following conglomerate theorem as indication that this program overlaps with the one we have been describing already:
\begin{theorem}\label{OmnibusEinftyTheorem}
The following are examples of \(E_\infty\)--ring spectra:
\begin{itemize}
    \item (\cite[Section VIII.1]{MayRingSpacesSpectra}) The classical \(K\)--theories \(KU\) and \(KO\).
    \item (\cite[Section VIII.1]{MayRingSpacesSpectra}) The Eilenberg--Mac Lane spectra \(HR\).
    \item (\cite[Corollary 7.6--7]{GoerssHopkins}) The Morava \(E\)--theories \(E_\Gamma\) and their fixed point spectra.\footnote{Notably, the Morava \(K\)--theories are \emph{not} \(E_\infty\)--rings at finite heights, in view of \Cref{HinftyRingsModp}.}
    \item (\cite[Section IV.3]{MayRingSpacesSpectra}) The Thom spectra arising from the \(J\)--homomorphism, including \(MO\), \(M\SO\), \(M\Spin\), \(M\String\), \(MU\), \(M\SU\), and \(MU[6, \infty)\).
    \item (\cite{BehrensConstruction}, cf.\ \Cref{ConstructionOfTMFSection}) The spectra \(\TMF\), \(\Tmf\), and \(\tmf\). \qed
\end{itemize}
\end{theorem}

The forgetful map from \(E_\infty\)--rings down to ring spectra in the homotopy category factors through an intermediate category, that of \(H_\infty\)--ring spectra, which captures the extra factorizations expressing these associativity and commutativity relations.  Specifically, recall the following definition from the discussion in \Cref{QuillenPowerOpnsSection}:

\begin{definition}[{\cite[Definition I.3.1]{BMMS}, cf.\ \Cref{QuillenPowerOpnsSection}}]
An \index{H infty ring spectrum@\(H_\infty\)--ring spectrum}\(H_\infty\)--ring spectrum is a ring spectrum \(E\) equipped with factorizations \(\mu_n\) as in
\begin{center}
\begin{tikzcd}
E^{\sm n} \arrow["\mu"]{r} \arrow{d} & E \\
E^{\sm n}_{h\Sigma_n} \arrow{ru}[description]{\mu_n},
\end{tikzcd}
\end{center}
which are subject to compatibilities induced by the inclusions \(\Sigma_n \times \Sigma_m \subseteq \Sigma_{n+m}\) and the inclusions \(\Sigma_n \wr \Sigma_m \subseteq \Sigma_{nm}\).
\end{definition}

\begin{lemma}
Each \(E_\infty\)--ring spectrum gives rise to an \(H_\infty\)--ring spectrum in the homotopy category. \qed
\end{lemma}

\noindent We care about this secondary definition because our results thus far have all concerned the cohomology of spaces, which is, at its core, a calculation at the level of \emph{homotopy classes}.  This is therefore as much of the \(E_\infty\)--structure as one could hope would interact with our analyses in the preceding Case Studies.

In \Cref{QuillenPowerOpnsSection} we introduced an \(H_\infty\)--ring structure on \(MU\), and in \Cref{StabilizingTheMUSteenrodOps} and \Cref{CalculationOfMUStarSection} we used it to make a calculation of the coefficient ring \(MU_*\).  Our first goal in this Appendix is to introduce an \(H_\infty\)--ring structure on certain chromatically interesting spectra, including Morava's theories \(E_\Gamma\), and to describe the compatibility laws arising from intertwining these two \(H_\infty\)--structures.  The culminating result is as follows:

\begin{theorem}[{cf.\ \Cref{AHSHinftyResultForEthy}}]
An orientation \(MU[6, \infty) \to E_\Gamma\) is \(H_\infty\) if and only if the induced cubical structure is \index{norm!coherence}``norm-coherent'' (cf.\ \Cref{NormCoherentDefn}). \qed
\end{theorem}

\noindent Before addressing this, we discuss in \Cref{CharacterTheorySection} an important phenomenon: after deleting certain forms of torsion, the Morava \(E_\Gamma\)--homology of a finite spectrum can be well--approximated by its Morava \(E_{\Gamma'}\)--homology where \(\Gamma'\) satisfies \(\height{\Gamma'} < \height{\Gamma}\).  This is interesting in its own right, and we will quickly see that the precise form of the approximation bears directly on the study of power operations.

Secondly, with the homotopy category exposed, we turn to \(E_\infty\)--ring spectra themselves: we give a summary of the known results about \(E_\infty\) orientations in \Cref{JuvitopTalkSection}, but in \Cref{ConstructionOfTMFSection} we first introduce the spectrum \(\TMF\), which is the primary target of the \(\String\)--orientation.













\section{Rational chromatic phenomena (Nathaniel Stapleton)}\label{CharacterTheorySection}

Before embarking on the rather ambitious project of understanding the collection of \(H_\infty\)--ring maps \(\phi\co MU[6, \infty) \to E_\Gamma\), it would be instructive to be able to answer the following: if we had such an orientation, would data could we extract from it?  The main feature of such a map is that it belongs to a commutative diagram
\begin{center}
\begin{tikzcd}
MU[6, \infty)^0(X) \arrow["\phi"]{r} \arrow["P^{\Sigma_n}_{MU[6, \infty)}(X)"]{d} & E^0(X) \arrow["P^{\Sigma_n}_E(X)"]{d} \\
MU[6, \infty)^0(B\Sigma_n \times X) \arrow["P^{\Sigma_n}(\phi)"]{r} & E^0(B\Sigma_n \times X).
\end{tikzcd}
\end{center}
Before understanding the maps in this commutative diagram, we must understand its nodes.  There is a natural map \[E^0(B\Sigma_n) \otimes_{E^0} E^0(X) \to E^0(B\Sigma_n \times X),\] and whether it is an equivalence is highly dependent on the structure of \(E^0(B\Sigma_n)\) itself---for instance, this would be the case if \(E^0(B\Sigma_n)\) were flat as an \(E^0\)--module.  For this reason, we are strongly motivated to feel out any foothold on this object that we are able to find, and a critical such foothold is the chromatic character theory of Hopkins, Kuhn, and Ravenel~\cite{HKR}.  Their theorems describe the Morava \(E\)--cohomology of a finite group with certain forms of torsion (e.g., \(p\)--torsion) deleted, and we give an introduction to their results in this Lecture.\footnote{The intrepid reader who finds this material interesting should also look at: the paper by Morava~\cite{MoravaLocalFieldsExtraordinaryKthy}, which discusses much of the same material here in slightly different terms; the paper by Greenlees--Strickland~\cite{GreenleesStrickland}, which discuss a ``transchromatic'' version of these results, where they study the object $i_d^* j_d{}_* (\moduli{fg})^\wedge_\Gamma$ of \Cref{LEFTRealTheoremWithProof}; and the paper by Stapleton~\cite{Stapleton}, which streamlines and generalizes the results of Greenlees--Strickland by invoking the geometry of $p$--divisible groups.}



\input{characters}










\section{Orientations and power operations}\label{PowerOpnsSection}

Our introduction of \(E_\infty\)--rings also automatically introduces a few interesting accompanying functors:
\begin{center}
\begin{tikzcd}
\CatOf{Spaces} \arrow["E^{(-)_+}", bend left]{rr} & \CatOf{Modules}_E \arrow["\P_E", shift left=0.4em]{r} \arrow[shift left=0.4em]{d} & \EinftyRings_E \arrow[shift left=0.4em]{l} \arrow[shift left=0.4em]{d} \\
& \CatOf{Spectra} \arrow[shift left=0.4em, "(-) \sm E"]{u} \arrow["\P", shift left=0.4em]{r} & \EinftyRings. \arrow[shift left=0.4em, "(-) \sm E"]{u} \arrow[shift left=0.4em]{l}
\end{tikzcd}
\end{center}
The first functor sends a space \(X\) to its spectrum of \(E\)--cochains \(E^{\Susp^\infty_+ X}\), and the other two functors form a free/forgetful monad\index{descent!monadic} resolving a mapping space in \(\EinftyRings_E\) by a sequence of mapping spaces in \(\CatOf{Modules}_E\).  These kinds of functors are familiar to us from the discussion of contexts in \Cref{StableContextLecture} and \Cref{UnstableContextsSection}, and the recipe applied in those situations gives an analogous story here.  First, there is a natural map \[\CatOf{Spaces}(*, X) \to \EinftyRings_E(E^{X_+}, E),\] which one hopes is an equivalence under (often very strong) hypotheses on \(E\) and on \(X\).\footnote{Mandell has shown this assignment for \(E = \HFp\) is an equivalence on connected \(p\)--complete nilpotent spaces of finite \(p\)--type~\cite{Mandell}.  There is an analogous unpublished theorem of Hopkins and Lurie: this assignment for \(E = E_\Gamma\) is an equivalence if \(X\) is a nilpotent space admitting a finite Postnikov system with at most \(\height \Gamma\) stages and involving only finite groups.}  Second, the adjunction gives a mechanism for resolving \(E^{X_+}\), which feeds into a spectral sequence computing this right-hand mapping space.  The functors \(\P\) and \(\P_E\) can be given by explicit formulas:
\begin{align*}
\P(X) & = \bigvee_{j=0}^\infty X^{\sm j}_{h\Sigma_j}, &
\P_E(M) & = \bigvee_{j=0}^\infty M^{\sm_E j}_{h\Sigma_j}.
\end{align*}
Finally, we expect the homotopy groups of this resolution to form a quasicoherent sheaf over a suitable \emph{\(E_\infty\) context}, which arises as the simplicial scheme associated to this resolution in the case where \(X\) is a point.  In this case, we can explicitly name some of the terms in this resolution: the bottom two stages take the form
\begin{center}
\begin{tikzcd}[column sep=1.5em]
\EinftyRings_E(E, E) \\
\EinftyRings_E(\P_E(E), E) \arrow{u} \arrow{r} & \EinftyRings_E(\P_E^2(E), E) \arrow[shift left=0.4em]{l} \arrow[shift right=0.4em]{l} \arrow[shift left=0.4em] {r} \arrow[shift right=0.4em]{r} & \arrow[shift left=0.8em]{l} \arrow{l} \arrow[shift right=0.8em]{l} \cdots.
\end{tikzcd}
\end{center}
The available adjunctions give a more explicit presentation of these terms:
\begin{align*}
\EinftyRings_E(\P_E(E), E) & \simeq \CatOf{Modules}_E(E, E) \\
& \simeq \CatOf{Spectra}(\S, E),
\intertext{which on homotopy groups computes the coefficient ring of \(E\), and}
\EinftyRings_E(\P_E^2(E), E) & \simeq \CatOf{Modules}_E(\P_E(E), E) \\
\simeq \CatOf{Modules}_E\left(\bigvee_{j=0}^\infty E^{\sm_E j}_{h\Sigma_j}, E\right) & \simeq \prod_{j=0}^\infty \CatOf{Spectra}\left(B\Sigma_j, E\right),
\end{align*}
which on homotopy groups is made up of a product of the cohomology rings \(E^*(B\Sigma_j)\).  The higher terms track the compositional behavior of these summands.

\begin{remark}[{\cite{BousfieldUnstableLocalization,MahowaldThompson,BousfieldLambdaRings,Davis}}]
One of the first places these ideas appear in the literature is in work of Mahowald and Thompson.  Bousfield defined an unstable local homotopy type associated to a (simply-connected) space and a homology theory.  In the case of the space \(S^{2n-1}\) and \(p\)--adic \(K\)--theory, Mahowald and Thompson calculated that \(L_K S^{2n-1}\) appears as the homotopy fiber \[L_K S^{2n-1} \to L_K \Loops^\infty \Sigma^\infty S^{2n-1} \to L_K \Loops^\infty \Sigma^\infty ((S^{2n-1})^{\sm p}_{h\Sigma_p}),\] which is an abbreviated form of the monadic resolution described above.
\end{remark}

\begin{remark}[{\cite[Theorem 4.5]{GoerssHopkins}}]
In general, if \(E^* B\Sigma_j\) is sufficiently nice, then the the \(E^2\)--page of the monadic descent spectral sequence computes the derived functors of derivations, taken in a suitable category of monad-algebras for the monad specifying the behavior of power operations.
\end{remark}






\subsection*{Strickland's theorems}

We thus set out to understand the formal schemes constituting the \(E_\infty\) context associated to Morava \(E\)--theory.\footnote{Much of the analysis for the case of \(\HFtwo\) can be read off from a pleasant paper of Baker~\cite{Baker}.}  As described in \Cref{UnstableContextsSection} and \Cref{UnstableAlgebraicModelSection}, the correct language for these phenomena are schemes defined on Hopf rings, together with the adjunction between classical rings and Hopf rings consisting of the \(\ast\)--square--zero extension functor and the \(\ast\)--indecomposables functor.  The rings \(E^0 B\Sigma_j\) assemble into a Hopf ring using the following structure:
\begin{itemize}
    \item The \(\ast\)--product comes from the stable transfer maps \(B\Sigma_{i+j} \to B\Sigma_i \times B\Sigma_j\).
    \item The \(\circ\)--product comes from the diagonal maps \(B\Sigma_j \to B\Sigma_j \times B\Sigma_j\).
    \item The diagonal comes from the block-inclusion maps \(B\Sigma_i \times B\Sigma_j \to B\Sigma_{i+j}\).
\end{itemize}

\begin{definition}
Accordingly, we set the \index{context!natural Einfty@natural \(E_\infty\)}\textit{natural \(E_\infty\) context} to be \[\Econtext{E_\Gamma} = \SpH E^0 B\Sigma_*.\]
\end{definition}

The effect of this functor on classical rings follows from our work in \Cref{UnstableAlgebraicModelSection}: \(\Econtext{E_\Gamma}(T) = \CatOf{Algebras}_{E_\Gamma^0}(Q^* E^0 B\Sigma_*, T)\), where \[Q^* E^0 B\Sigma_* = \frac{E^0 B\Sigma_*}{\bigcup_{j+k=*}\im\left(\Tr_{\Sigma_j \times \Sigma_k}^{\Sigma_{j + k}}\co E^0 B\Sigma_j \times E^0 B\Sigma_k \to E^0 B\Sigma_{j+k}\right)}.\]  The ideal appearing in this equation is called the \index{norm}\index{transfer|see {norm, equivariant}}\textit{transfer ideal}, written \(I_{\Tr}\).

\begin{remark}
In terms of the descent spectral sequence described in the previous subsection, all of the \(*\)--decomposables are in the image of the \(d^1\)--differential, so already do not contribute to the \(E^2\)--page of the spectral sequence.
\end{remark}

We dissect this Hopf ring spectrum by considering the \(j\){\th} graded piece of \(\Econtext{E_\Gamma}\) as restricted to classical rings, i.e., by understanding the formal schemes \(\Spec (E^0 B\Sigma_j / I_{\Tr})\) for individual indices \(j\).

\begin{example}[{\cite[Appendix]{SchlankStapleton}}]
To gain a foothold, it is helpful to further specialize to a particular case---say, \(j = p\).  In light of the results of \Cref{CharacterTheorySection}, we might begin by analyzing the (maximal) abelian subgroups of \(\Sigma_p\), of which the only \(p\)--locally interesting one is the transitive subgroup \(C_p \subseteq \Sigma_p\).  In \Cref{KtheoryConvertsTorsionToTorsion}, we calculated \(BS^1[p]_E = \CP^\infty_E[p]\), and we now make the further observation that the regular representation map \(\rho\co BS^1[p] \to BU(p)\) induces the following map on cohomological formal schemes:
\begin{center}
\begin{tikzcd}
BS^1[p]_E \arrow["\rho_E"]{r} & BU(p)_E \\
\InternalHom{FormalGroups}(\Z/p, \CP^\infty_E) \arrow{r} \arrow[equal]{u} & \Div_p^+ \CP^\infty_E \arrow[equal]{u},
\end{tikzcd}
\end{center}
where the bottom arrow sends such a homomorphism to its image divisor.  This map belongs to a larger diagram of schemes:
\begin{center}
\begin{tikzcd}
\Spf E^0 B\Sigma_p / I_{\Tr} \arrow{r} & (B\Sigma_p)_E \arrow{r} & BU(p)_E \\
\Spf E^0 BC_p / I_{\Tr} \arrow{r} \arrow{u} & (BC_p)_E \arrow{u} \arrow{ru}.
\end{tikzcd}
\end{center}
The quotient by the transfer ideal in \((BC_p)_E\) is modeled by the map
\begin{center}
\begin{tikzcd}
E^0 BC_p / I_{\tr} \arrow[equal]{d} & E^0 BC_p \arrow{l} \arrow[equal]{d} \\
E^0\ps{x} / \<p\>(x) & E^0\ps{x} / [p](x) \arrow{l},
\end{tikzcd}
\end{center}
which disallows the zero homomorphism and forces the image divisor to be a subdivisor of \(\CP^\infty_E[p]\).  Such a homomorphism is an example of a \index{level structure}\textit{level structure}, and the scheme of such homomorphisms is written \(\Level(\Z/p, \CP^\infty_E)\).  Finally, passing to \(B\Sigma_p\) from \(BC_p\) exactly destroys the choice of generator of \(\Z/p\), i.e., it encodes passing from the homomorphism to the image divisor.  This winds up giving an isomorphism \[\Spf E^0 B\Sigma_p / I_{\Tr} \cong \Sub_p \CP^\infty_E,\] where \(\Sub_p\) denotes the subscheme of \(\Div_p^+\) consisting of those effective Weil divisors of rank \(p\) which are subgroup divisors.
\end{example}

The broad features of this example hold for a general index \(j\).
\begin{definition}
The \index{context!abelian Einfty@abelian \(E_\infty\)}\textit{abelian \(E_\infty\) context} is formed by considering the inclusions \[\bigvee_{\substack{A \le \Sigma_j \\ \text{\(A\) abelian}}} BA \to B\Sigma_j.\]
\end{definition}
\noindent A consequence of \Cref{CharacterTheorySection} is that this map is \emph{injective} on Morava \(E\)--cohomology, so that we can understand the natural \(E_\infty\) context in terms of this larger object.  A benefit to this auxiliary context is that we can already predict its behavior in Morava \(E\)--theory: the cohomological formal scheme associated to an abelian group can be presented as an internal scheme of group homomorphisms, just as above.  Using this auxiliary context for reference, Strickland has proven the following results:

\begin{theorem}[{\cite[Theorem 1.1]{StricklandEthyOfBSigma}}]
There is an isomorphism \[\Spf E^0 B\Sigma_j / I_{\Tr} \cong \Sub_j \CP^\infty_E,\] where \(\Sub_j\) denotes the subscheme of \(\Div_j^+\) consisting of those effective Weil divisors of rank \(j\) which are \index{divisor!subgroup}subgroup divisors.\footnote{If \(j\) is not a power of \(p\), this is the terminal scheme.}
\end{theorem}
\begin{proof}[Proof sketch, after Stapleton]
The proof of this Theorem requires a very involved algebraic calculation (which can take different forms~\cite{StricklandFiniteSubgps,SchlankStapleton}), so we describe only the reduction to that calculation.  The object \(E^0 B\Sigma_j\) is accessible via the chromatic character theory from the previous Lecture, where we presented \(C_0 \otimes E^0 B\Sigma_j\) as a certain ring of \(C_0\)--valued class functions on the symmetric group.  The effect of quotienting by the transfer ideal is to delete all of the factors belonging to conjugacy classes that are not transitive.  On the other side of the putative isomorphism, the formation of the scheme of subgroups commutes with base change, and hence we have \[\Spec C_0 \times \Sub_j \CP^\infty_E \cong \Sub_j (\Spec C_0 \times \CP^\infty_E) \cong \Sub_j \Lambda^*,\] where in the second isomorphism we have used the canonical isomorphism carried by the ring $C_0$.  After this character-theoretic base-change, there is a canonical bijection between the two sides: a map \[\Z_p^n \xrightarrow{\mathrm{transitive}} \Sigma_n\] has an image factorization \(\Z_p^n \to A \to \Sigma_n\), and the Pontryagin dual of the surjective map in the factorization gives an injective map \[\Lambda^* \leftarrow A^*.\]

As described above, the permutation representation gives a natural map \(B\Sigma_j \to BU(j)\), which participates in the following square:
\begin{center}
\begin{tikzcd}
E^0 BU(j) \arrow{r} \arrow["\simeq", leftarrow]{d} & E^0 B\Sigma_j / I_{\Tr} \arrow["\mathrm{inj.}"]{r} & C_0 \otimes E^0 B\Sigma_j \arrow["\simeq", leftarrow]{d} / I_{\Tr} \\
\sheaf O(\Div_j^+ \CP^\infty_E) \arrow["\mathrm{surj.}"]{r} & \sheaf O(\Sub_j \CP^\infty_E) \arrow["\mathrm{inj.}"]{r} \arrow[densely dotted]{u} & \sheaf O(\Sub_j \Lambda^*).
\end{tikzcd}
\end{center}
The left-hand isomorphism is stated in \Cref{IdentificationOfBUnWithDivn}; the right-hand isomorphism is the content of the previous paragraph; the bottom-left horizontal map is surjective because subgroup divisors form a closed subscheme of all divisors; the top horizontal map is an injection by a difficult theorem of Strickland~\cite[Theorems 8.5--6]{StricklandEthyOfBSigma}; and the bottom horizontal map is an injection by a second difficult theorem of Strickland~\cite[Theorem 10.1]{StricklandFiniteSubgps}.  In fact, the two difficult theorems say more: they show that the two terms are finite and free of equal rank.  Altogether, these can be used to define the middle vertical map: any element in the bottom can be preimaged along the surjection, translated along the isomorphism, and pushed back down along the map induced by the regular representation.  One quickly checks that this gives a well-defined injective $E^0$--algebra homomorphism.

What remains to show, then, is that this last injection is an isomorphism, whether by calculating the relevant determinant~\cite[Section 7.9]{SchlankStapleton} or by explicitly analyzing a generating element in terms of Euler classes~\cite[Theorem 9.2]{StricklandEthyOfBSigma}.
\end{proof}

Related methods also describe the abelian context:

\begin{theorem}[{\cite[pg.\ 45]{StricklandFPFP}}]
For a finite abelian group \(A\), there is a diagram
\begin{center}\vspace{-\baselineskip}
\begin{tikzcd}[column sep=0.7em]
\left.\Spf E^0 BA \middle/ \left( \sum_{\substack{a \in A \\ a \ne 0}} \operatorname{ann}(a) \right) \right. \arrow{r} \arrow[equal]{d} & \Spf E^0 BA / I_{\Tr} \arrow{r} & \Spf E^0 BA \arrow[equal]{d} \\
\Level(A^*, \CP^\infty_E) \arrow{rr} & & \InternalHom{FormalGroups}(A^*, \CP^\infty_E),
\end{tikzcd}
\end{center}
where \index{level structure}\(\Level(A^*, \CP^\infty_E)\) denotes the subscheme of \(\InternalHom{FormalGroups}(A^*, \CP^\infty_E)\) consisting of homomorphisms which are subject to the condition that \(A^*[n]\) forms a subdivisor of \(\CP^\infty_E[n]\).\footnote{If \(A[p] \cong (\Z/p)^{\times k}\) has \(k > \height{\Gamma}\), then this is the terminal scheme.} \qed
\end{theorem}

\begin{remark}
An important piece of intuition about the schemes of level structures \(\Level(A^*, \CP^\infty_E)\) is that they form a kind of replacement for the nonexistent ``scheme of monomorphisms''.  Specifically, the \(p\)--series for a Lubin--Tate universal deformation group is only once \(x\)--divisible, and hence the divisor \(\G[p]\) only contains the divisor \([0]\) with multiplicity one.\footnote{This kind of reasoning applies to domains of characteristic \(0\) generally.}  This excludes noninjective morphisms in this case.  On the other hand, the only subgroups of the formal group restricted to the special fiber are of the form \(p^m \cdot [0]\).  In particular, any level structure on \(\G\) restricts to a morphism with this image divisor at the special fiber, and hence functoriality considerations force us to count these---which are \emph{not} images of monomorphisms---as level structures as well.\footnote{On the other hand, the scheme of level structures tracks \emph{exactly} monomorphisms after tensoring up with the ring $C_0$ of \Cref{CharacterTheorySection}.}
\end{remark}

\begin{remark}[{\cite{StricklandFiniteSubgps}}]
The schemes \(\Sub_j \G\) and \(\Level(A, \G)\) are known to possess many very pleasant algebraic properties: they are finite and free of predictable rank, they have Galois descent properties, the schemes \(\Level(A, \G)\) are all reduced, there are important decompositions coming from presenting a subgroup scheme as a flag of smaller subgroups, \ldots.  Indeed, these algebraic results form important ingredients to the proof of the connection with homotopy theory~\cite[Section 9]{StricklandEthyOfBSigma}.
\end{remark}

\begin{remark}[{\cite{RezkKoszul}}]
Rezk has shown that the \(E_\infty\) descent object for Morava \(E\)--theory is, in a certain sense, of finite length.  Specifically, there is a subobject of the descent object which consists levelwise of those \index{divisor!flag of subgroups}flags of formal subgroups of \(\G_E\) whose composition is contained in \(\G[p]\), and the Koszul condition entails that this inclusion induces a weak equivalence of derived categories.
\end{remark}










\subsection*{Isogenies and the Lubin--Tate moduli}\label{IsogeniesSection}

In this subsection, we seek a comparison of the natural \(E_\infty\) context and the \index{context!unstable}unstable context considered in \Cref{UnstableContextsSection}.  Our model for the unstable context in \Cref{UnstableAlgebraicModelSection} focuses on the effect of unstable operations on the cohomology of \(\CP^\infty\), as summarized in the following result:

\begin{lemma}[{mild extension of \Cref{LEFTUnstableCooperations} along the lines of \Cref{HopfRingForEBP}; cf.\ also \cite[Theorem 1.1]{Thompson}}]\label{UnstableEthyCooperations}
There is an isomorphism \[\Spec Q^* \pi_* L_\Gamma(E \sm E) \cong \InternalHom{FormalGroups}(\CP^\infty_E, \CP^\infty_E). \qed\]
\end{lemma}

\noindent In order to form a comparison map between these two contexts, we will want algebraic constructions that trade a subgroup divisor (i.e., a point in the natural \(E_\infty\) context) for a formal group endomorphism (i.e., a point in the unstable context).  It will be useful to phrase our ideas in the language of \index{isogeny}\textit{isogenies}.

\begin{definition}[{\cite[Definition 5.17]{StricklandFSFG}}]
Take \(C\) and \(D\) to be formal curves over \(X\).  A map \(f\co C \to C'\) is an \index{isogeny}\textit{isogeny} (of degree \(d\)) when the induced map \(C \to C \times_X C'\) exhibits \(C\) as a divisor (of rank \(d\)) on \(C \times_X C'\) as \(C'\)--schemes.
\end{definition}

\begin{remark}[{cf.\ \Cref{DivHasPushforwards}}]
In this case, a divisor \(D\) on \(C'\) gives rise to a divisor \(f^* D\) on \(C\) by scheme-theoretic \index{divisor!pullback}pullback:
\begin{center}
\begin{tikzcd}
f^* D \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & D \arrow{d} \\
C \arrow["f"]{r} & C',
\end{tikzcd}
\end{center}
altogether inducing a map \[f^*\co \Div_n^+ C' \to \Div_{nd}^+ C.\]  This map interacts with pushforward by \(f_* f^* D = d \cdot D\), where \(d\) is the degree of the isogeny.
\end{remark}

The usual source of examples of isogenies are polynomial maps between curves.  In fact, this is close to the general case, and the following result is the source of much intuition:
\begin{lemma}[{Weierstrass preparation, \cite[Section 5.2]{StricklandFSFG}}]\index{Weierstrass preparation}
Let \(R\) be a complete local ring.  Every degree \(d\) isogeny \(f\co \A^1_R \to \A^1_R\) admits a unique factorization as a coordinate change and a monic polynomial of degree \(d\). \qed
\end{lemma}

\noindent In the case of formal groups over a perfect field of positive characteristic, this reduces to two familiar structural results:

\begin{corollary}
Every nonzero map of formal groups over a perfect field of positive charactersitic can be factored as an iterate of Frobenius and a coordinate change.\footnote{Incidentally, the Frobenius iterate appearing in the Weierstrass factorization of the multiplication-by-\(p\) isogeny \(p\co \G \to \G\) is another definition of the height of \(\G\).} \qed
\end{corollary}

\begin{corollary}
A map of formal groups over a complete local ring with a perfect positive-characteristic residue field is an isogeny if and only if the kernel subscheme of the map is a divisor. \qed
\end{corollary}

This last result forms the headwaters of the connection we are seeking: isogenies are exactly the class of formal group homomorphisms whose kernels form subgroup divisors.  Again, we are seeking an assignment in the opposite direction, some special collection of endoisogenies naturally attached to prescribed kernel divisors.  As a first approximation to this goal, we drop the \emph{endo-} and aim to construct just \emph{isogenies} with this kernel property, a candidate for which is a theory of \index{formal group!quotient}\textit{quotient groups}.

\begin{definition}
For \(K \subseteq \G\) be a subgroup divisor, we define the quotient group \(\G/K\) to be the formal scheme whose ring of functions is the equalizer
\begin{center}
\begin{tikzcd}
\sheaf O_{\G/K} \arrow{r} & \sheaf O_{\G} \arrow[shift left=0.4em, "\mu^*"]{r} \arrow[shift right=0.4em, "1 \otimes \eta^*"']{r} & \sheaf O_{\G} \otimes \sheaf O_K.
\end{tikzcd}
\end{center}
\end{definition}

\begin{lemma}[{\cite[Theorem 5.3.2-3]{StricklandFiniteSubgps}}]
The functor \(\G/K\) is again a \(1\)--dimensional smooth commutative formal group. \qed
\end{lemma}

The inclusion of rings of functions determines an isogeny \(q\co \G \to \G/K\) of degree \(|K|\).  In this particular case, the induced pullback map \(q^*\) of divisor schemes has an especially easy formulation:
\begin{lemma}
Pullback along the isogeny \(q\co \G \to \G/K\) is computed by \[q^* \co D \mapsto D * K,\] where \(*\co \Div_n^+ \G \times \Div_d^+ \G \to \Div_{nd}^+ \G\) is the \index{divisor!convolution}convolution product of divisors on formal groups as described in \Cref{ProductMapOfDivisorSchemes}. \qed
\end{lemma}

In the case that \(K\) is specified by a level structure, this admits a further refinement:
\begin{corollary}
Let \(\ell\co A \to \G\) be a level structure parametrizing a subgroup divisor \(K\).  The divisor pullback map can then be computed by the expansion \[q^* D = \sum_{a \in A} \tau_{\ell(a)}^* D,\] where \(\tau_g\co \G \to \G\) is the translation by \(g\) map. \qed
\end{corollary}

\begin{definition}\label{NormForFns}
This second construction can be upgraded to an assignment from \emph{functions} on \(\G\) to \emph{functions} on \(\G/K\), rather than just the ideals that they generate.  Specifically, we define the \index{norm}\textit{norm} of \(\phi \in \sheaf O_{\G}\) along a level structure \(\ell\co A \to \G\) by the formula \[N_\ell \phi = \prod_{a \in A} \tau_{\ell(a)}^* \phi.\]  An often-useful property of this norm construction is that if \(\phi\) is a coordinate on \(\G\), then \(N_\ell \phi\) is a coordinate on \(\G/K\)~\cite[Theorem 5.3.1]{StricklandFiniteSubgps}.
\end{definition}

\begin{remark}
In general, the pullback map \(q^*\) admits the following description: an isogeny \(q\co C \to C'\) gives a presentation of \(\sheaf O_C\) as a finite free \(\sheaf O_{C'}\)--module.  A function \(\phi \in \sheaf O_C\) therefore begets a linear endomorphism \(\phi \cdot (-) \in \operatorname{GL}_{\sheaf O_{C'}}(\sheaf O_C)\), and the determinant of this map gives an element of \(q^* \phi \in \sheaf O_{C'}\).  Letting \(\phi\) range, this gives a multiplicative (but not typically additive) map \(q^*\co \sheaf O_C \to \sheaf O_{C'}\).  If a divisor \(D\) is specified as the zero-locus of a function \(\phi_D\), the divisor \(q^* D\) is specified as the zero-locus of \(q^* \phi_D\).
\end{remark}

Our last technical remark is that this definition of quotient does, indeed, have the suggested universal property:

\begin{lemma}[First isomorphism theorem for formal groups, {\cite{Lubin}, \cite[Theorem 5.3.4]{StricklandFiniteSubgps}}]
If \(f\co \G \to \widehat{\mathbb H}\) is any isogeny with kernel divisor \(K\), then there is a uniquely specified commuting triangle
\begin{center}
\begin{tikzcd}[row sep=1em]
& \G \arrow["q"']{ld} \arrow["f"]{rd} \\
\G/K \arrow["g", "\simeq"']{rr} & & \widehat{\mathbb H}. \qed
\end{tikzcd}
\end{center}
\end{lemma}

We now use this Lemma, along with properties of the Lubin--Tate moduli problem, to associate endo-isogenies to subgroup divisors.  To begin, consider the multiplication--by--\(p\) endo-isogeny of a Lubin--Tate group \(\G\).  Since \(\G\) is finite height, this map is an isogeny and the Lemma above gives rise to an isomorphism of formal groups
\begin{center}
\begin{tikzcd}[row sep=1em]
& \G \arrow["q"']{ld} \arrow["p"]{rd} \\
\G/\G[p] \arrow["g", "\simeq"']{rr} & & \G.
\end{tikzcd}
\end{center}
This diagram is one of formal groups, rather than of deformations---the map \(p\co \G \to \G\) does not cover the identity upon reduction to the special fiber.  The Frobenius allows us to correct this to a diagram of deformations:
\begin{center}
\begin{tikzcd}[row sep=1em]
& \G \arrow["q"']{ld} \arrow["p"]{rd} \\
\G/\G[p] \arrow["g", "\simeq"']{rr} & & (\phi^d)^* \G.
\end{tikzcd}
\end{center}
In particular, this latter diagram shows that the quotient map \(\G / \G[p]\) is \emph{again} a universal deformation, as witnessed by a preferred isomorphism to \(\G\).  For a generic subgroup divisor \(K \le \G\), we have access to the isogeny \(q_K\) using the methods described above, but it is the magic of the Lubin--Tate moduli that furnishes us with replacements for \(p\) and for \(g\).  Notice first that the problem simplifies dramatically for the formal group at the special fiber: all subgroups of the special fiber formal group are of the form \(p^j \cdot [0]\), and hence we can always use the Frobenius map to complete the desired triangle:
\begin{center}
\begin{tikzcd}[row sep=1em]
& \Gamma \arrow["q_{p^j[0]}"']{ld} \arrow["\Frob^j"]{rd} \\
\Gamma/(p^j\cdot[0]) \arrow["g_{p^j[0]}", "\simeq"']{rr} & & (\phi^j)^* \Gamma,
\end{tikzcd}
\end{center}
where \(\phi\co k \to k\) is the Frobenius on coefficients and \(\Frob\co \Gamma \to \phi^* \Gamma\) is the ``geometric Frobenius'', specified at the level of formal group \emph{laws} by the equation \(\Frob(x) = x^p\) and \[(x +_\Gamma y)^p = x^p +_{\phi^* \Gamma} y^p.\]

\begin{lemma}[{\cite[Section 12.3]{AHSHinfty}}]
Let \(G\) be an infinitesimal deformation of a finite height formal group \(\Gamma\) to a complete local ring \(R\).  Associated to a subgroup divisor \(K \le G\), there is a commuting triangle
\begin{center}
\begin{tikzcd}[row sep=1em]
& G \arrow["q_K"']{ld} \arrow["P_K"]{rd} \\
G/K \arrow["g_K", "\simeq"']{rr} & & \psi_K^* \G
\end{tikzcd}
\end{center}
for a map \(\psi_K\co \Spf R \to (\moduli{fg})^\wedge_\Gamma\) and \(\G\) the Lubin--Tate universal deformation of \(\Gamma\).
\end{lemma}
\begin{proof}
The main content of the deformation theory of finite height formal groups, recounted in \Cref{SectionMfgSmallScales}, is that there is a natural correspondence between the following two kinds of deformation data:
\[\left\{\begin{tikzcd}[column sep=0.7em, row sep=0.7em]
\Gamma \arrow{d} & i^* \Gamma \arrow{l} \arrow{rd} \arrow[equal, "\alpha"]{r} \arrow[dl, phantom, "\llcorner", very near start] & j^* G \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & G \arrow{d} \\
\Spec k & & \Spec R/\m \arrow["i"']{ll} \arrow["j"]{r} & \Spf R
\end{tikzcd}
\right\}
\leftrightarrow
\left\{\begin{tikzcd}[column sep=0.7em, row sep=0.7em]
G \arrow{rd} \arrow[equal, "\beta"]{r} & \psi^* \G \arrow{d} \arrow{r} \arrow[dr, phantom, "\lrcorner", very near start] & \G \arrow{d} \\
& \Spf R \arrow["\psi"]{r} & (\mathcal M_{\mathbf{fg}})^\wedge_\Gamma
\end{tikzcd}
\right\}.\]
Accordingly, to construct the map \(\psi_K\) from the Lemma statement, we need only exhibit \(G/K\) as belonging to a natural diagram of the sort at left.  Using the fact that finite subgroups of formal groups over a \emph{field} are always of the form \(p^j \cdot [0]\), this is exactly what the Frobenius discussion above accomplishes:
\begin{center}
\begin{tikzcd}[row sep=0.7em]
\Gamma \arrow{d} & (\phi^j)^* \Gamma \arrow{l} \arrow{rd} \arrow[equal, "g_{p^j[0]}"]{r} \arrow[dl, phantom, "\llcorner", very near start] & (j^* G)/p^j\cdot[0] \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & G/K \arrow{d} \\
\Spec k & & \Spec k \arrow["\phi^j"']{ll} \arrow["j"]{r} & \Spf R.
\end{tikzcd}
\end{center}
Transferring this to a diagram of the sort at right, this gives the map \(\psi_K\) and the isomorphism \(g_K\), and the map \(P_K\) is constructed as their composite.
\end{proof}

Applying this Lemma to the universal case gives the following result:

\begin{corollary}\label{DeterminationOfPowerMaps}
There is a unique sequence of maps \[P^{\Sigma_{p^k}}\co \G \times \Sub_{p^k} \G \to \psi_{p^k}^* \G\] determined by the following properties:
\begin{enumerate}
    \item Restricting to any point in \(\Sub_{p^k} \G\) gives a group homomorphism with that kernel.
    \item (\textit{Deformation of Frobenius}:) At the special fiber, \(P^{\Sigma_{p^k}}\) reduces to the \(k\){\th} Frobenius iterate.
    \qed
\end{enumerate}
\end{corollary}

Amazingly, this is exactly the behavior of any theory of \index{power operation}power operations for \(E\)--theory as applied to \(\CP^\infty\).  An \(H_\infty\) structure on Morava \(E\)--theory carries a \(\Sigma_{p^k}\)--power operation map \[E^0 \CP^\infty \otimes E^0 B\Sigma_{p^k} \from E^0 \CP^\infty,\] which corresponds to a map of formal schemes:
\begin{center}
\begin{tikzcd}
\Spf (E^0 \CP^\infty \otimes E^0 B\Sigma_{p^k} / I_{\Tr}) \arrow{r} \arrow[equal]{d} & \Spf E^0 \CP^\infty \arrow[equal]{d} \\
\CP^\infty_E \times \Sub_{p^k} \CP^\infty_E \arrow["P^{\Sigma_{p^k}}"]{r} & \CP^\infty_E.
\end{tikzcd}
\end{center}
This becomes an \(E^0\)--algebra map (i.e., a map of schemes over \((\moduli{fg})^\wedge_\Gamma\)) when the bottom map is factored as \[\CP^\infty_E \times \Sub_{p^k} \CP^\infty_E \xrightarrow{P^{\Sigma_{p^k}}} \psi_{\Sigma_{p^k}}^* \CP^\infty_E \to \CP^\infty_E.\]  This map has exactly the prescribed kernel, and by its very nature as a \emph{power operation} it reduces to the Frobenius on the special fiber---and thus the unicity of \Cref{DeterminationOfPowerMaps} applies.  Finally, this identification is definitionally compatible with the map sending a power operation to its constituent sum of unstable operations, i.e., the map from the natural \(E_\infty\) context to the unstable context.

\begin{remark}[{\cite[1.4.2.3]{CCO}}]
There is a useful result about isogenies that more topologists ought to be aware of, although it doesn't tie in directly to any of our exposition here.  Nonetheless, we record its statement: for \(R\) a sufficiently nice complete local ring, and for \(\mathbb G\) and \(\mathbb G'\) two \(p\)--divisible groups over \(R\), reduction to the special fiber gives an injection \[\Isog(\mathbb G, \mathbb G') \into \Isog(\mathbb G \times \Spec R/\m, \mathbb G' \times \Spec R/\m).\]
\end{remark}











\subsection*{\(H_\infty\)--orientations}

Having worked through enough of the underlying algebra, we now return to our intended application: \(H_\infty\) complex-orientations of Morava \(E\)--theory.  As we have avoided endowing \(E\)--theory with an \(H_\infty\)--structure so far, there are some open questions as to what this might mean.  To resolve this ambiguity, recall first from \Cref{OmnibusEinftyTheorem} that there exists at least one \(H_\infty\)--ring structure on Morava \(E\)--theory.  Next, notice that the set of \(H_\infty\)--ring maps is the subset of homotopy classes of ring maps which commute with the \(\Sigma_n\)--power operations on the source and target.  In the case of \(MUP\)--orientations, this has a surprising effect: since an ordinary ring map \(MUP \to E\) corresponds to a map \(\CP^\infty \to E\), the theory of \(H_\infty\)--orientations can be entirely read off from the behavior of the power operations on \(\CP^\infty\).  Additionally, the behavior of \emph{any} putative theory of \(E\)--theoretic power operations on this particular space was totally determined in the previous section.  We therefore need not be more specific.

Beyond these observations, there are two reductions, both due to McClure, that lighten our workload from infinitely many conditions to check to two:

\begin{theorem}[{\cite[Proposition VIII.7.2]{BMMS}}]
Let \(E\) and \(F\) be \(H_\infty\)--ring spectra with \(F\) \(p\)--local, and let \(f\co E \to F\) be a map of ring spectra in the homotopy category.  Then \(f\) is furthermore an \(H_\infty\)--ring map if and only if the following equation is satisfied:
\[
\pushQED{\qed}
f \circ P^{\Sigma_p}_E = P^{\Sigma_p}_F \circ f^{\sm p}_{h\Sigma_p}. \qedhere
\popQED
\]
\end{theorem}

\begin{theorem}[{\cite[Proposition 33]{HopkinsLawson}}]
Let \(E\) be an \(E_\infty\)--ring spectrum and let \(X\) be a space such that \(E^{\Susp^\infty_+ X}\) is a wedge of copies of \(E\).  The map \[\iota^* \otimes \Delta^*\co \widetilde E^* X^{\sm G}_{hG} \to \widetilde E^* X^{\sm G} \oplus \widetilde E^*(X \sm BG_+)\] is then injective.\footnote{The actual statement of McClure's result~\cite[Proposition VIII.7.3]{BMMS} has several additional hypotheses: \(\pi_* E\) is taken to be even-concentrated and free over \(\Z_{(p)}\), \(X\) has homology free abelian in even dimensions and zero in odd dimensions, and \(X\) and \(E\) are both taken to be finite type.  Although this is the theorem cited in the source material~\cite[Section 4]{Ando}~\cite[Proof of Proposition 6.1]{AHSHinfty}, the version that has the weak hypotheses that we require only appeared in print much later.} \qed
\end{theorem}

\begin{corollary}[{\cite[pg.\ 271]{AHSHinfty}, \cite[Proposition VII.7.2]{BMMS}}]
A ring map \(x\co MUP \to E_\Gamma\) is \(H_\infty\) if and only if the internal power operations commute: \[
\pushQED{\qed}
x \circ \mu^{C_p}_{MUP} \circ \Delta = \mu^{C_p}_{E_\Gamma} \circ x^{\sm p}_{hC_p} \circ \Delta \in E_\Gamma^0 T(\L \otimes \rho \downarrow \CP^\infty \times BC_p).
\qedhere
\popQED
\]
\end{corollary}

We now expand the algebraic condition that this last Corollary encodes.  The power operation for \(MUP\) was described in \Cref{AjAndBjAreInTheFGLSubring}, where we found that it applies the norm construction to \(f\) for the universal \(\Z/p\)--level structure on \(\G\).  The cyclic power operation on Morava \(E\)--theory was determined in the previous section to act by pullback along the deformation of Frobenius isogeny associated to the same universal level structure.  This condition is important enough to warrant a name:

\begin{definition}\label{NormCoherentDefn}
A coordinate \(\phi\co \G \to \A^1\) on a Lubin--Tate group \(\G\) is said to be \index{norm!coherence}\textit{norm-coherent} when for all subgroups \(K \subseteq \G\), we have that \(N_K \phi\) and \(\psi_K^* \phi\) are related by the isomorphism \(g_K\).
\end{definition}

\begin{corollary}
The subset of those orientations which are \(H_\infty\) correspond exactly to those coordinates which are norm-coherent, and it suffices to check the norm-coherence condition just for the universal \(\Z/p\)--level structure. \qed
\end{corollary}

This characterization is already somewhat interesting, but it will only be truly interesting once we have found examples of such coordinates.  Our actual main result is that such coordinates are remarkably (and perhaps unintuitively) common.  In order to set up the statement and proof of this result, we consider the following somewhat more general situation:

\begin{definition}
A line bundle \(\L\) on \(\G\) together with a level structure \(\ell\co A \to \G\) induces a line bundle \(N_\ell \L\) on \(N_\ell \G\) according to the formula \[N_\ell \L = \bigotimes_{a \in A} \tau_{\ell(a)}^* \L.\]  This line bundle interacts with the norm-coherence triangles well: \(N_\ell \L = g_\ell^* \psi_\ell^* \L\).  However, the operations on individual sections can be different: a section \(s \in \Gamma(\L \downarrow \G)\) is said to be \textit{norm-coherent} when for any choice of level structure we have \(N_\ell s = g_\ell^* \psi_\ell^* s\).
\end{definition}

\begin{example}
In particular, functions \(\phi\co \G \to \A^1\) can be thought of as sections of the trivial line bundle \(\sheaf O_{\G}\), and coordinates can be thought of as trivializations of the same trivial line bundle.  We also remarked in \Cref{NormForFns} that the property of being a coordinate is stable under the operations on both sides of the norm-coherence equation.\footnote{This is reflected in topology as the assertion that the two power operations give two Thom classes for the regular representation, which must therefore differ by a unit.}
\end{example}

\begin{theorem}[{\cite[Theorem 2.5.7]{Ando}, \cite{PetersonStapleton}, \cite{Zhu}}]\label{AndosAlgebraicTheorem}
Let \(\L\) be a line bundle on a Lubin--Tate formal group \(\G\), and let \(s_0\) be a section of \(\L_0\), the restriction of \(\L\) to the formal group at the special fiber.  Then there exists exactly one norm-coherent section \(s\) of \(\L\) itself which restricts to \(s_0\).
\end{theorem}
\begin{proof}[Proof sketch]
The first observation is that the norm-coherence condition can be made sense of after reducing modulo any power of the maximal ideal in the Lubin--Tate ring, and that the resulting condition is trivially satisfied in the case where the entire maximal ideal is killed.  We then address the problem inductively: given a norm-coherent section modulo \(\m^j\), we seek a norm-coherent section modulo \(\m^{j+1}\) extending this.  By picking \emph{any} lift extending this, we can test the norm-coherence condition and produce an error-term that measures its failure to hold.  In the specific case of the canonical subgroup \(\G[p] \le \G\), this error term is contained in the Lubin--Tate ring, and so we can modify our lift by subtracting off this error term.  This perturbation has no effect on the ``norm'' side of the norm-coherence condition, and it has a linear effect on the ``\(\psi_{[p]}\)'' side, so it cancels with the error term to give a section which is norm-coherent \emph{only when tested against the canonical subgroup}.

One can already show that the unicity clause applies: there is only one section \(s\) of \(\L\) which reduces to \(s_0\) and which is norm-coherent for the canonical subgroup \(\G[p]\).  In order to conclude that \(s\) is truly norm-coherent, one shows that \(N_\ell s\) satisfies its own \([p]\)--norm-coherence condition (for the new canonical subgroup \((\G / \ell)[p] \le \G / \ell\)), forcing it to agree with \(\psi_\ell^* s\).
\end{proof}

\begin{corollary}\label{AHSHinftyResultForEthy}
Every orientation \(s_0\co MUP \to K_\Gamma\) extends uniquely to a diagram
\begin{center}
\begin{tikzcd}
MUP \arrow["s_0"]{rd} \arrow["s"]{d} \\
E_\Gamma \arrow{r} & K_\Gamma,
\end{tikzcd}
\end{center}
where \(s\) is an \(H_\infty\)--ring map. \qed
\end{corollary}

\begin{example}[{\cite[Section 2.7]{Ando}, cf.\ \Cref{ArtinHasseExponential}}]
The usual coordinate on \(\G_m\) with \(x +_{\G_m} y = x + y - xy\) satisfies the norm-coherence condition.  We compute directly in the case of the canonical subgroup:
\begin{align*}
N_{[2]}(x) & = x(x +_{\G_m} 2) \tag{\(p = 2\)} \\
& = x (x + 2 - 2x) = 2x - x^2 = 2^*(x), \\
N_{[p]}(x) & = \prod_{j=0}^{p-1} (x +_{\G_m} (1 - \zeta^j)) \tag{\(p > 2\)} \\
& = \prod_{j=0}^{p-1} (1 - \zeta^j(1 - x)) = (1 - (1 - x)^p) = p^*(x).
\end{align*}
This is exactly the computation that \(g_{[p]}^* \psi_{[p]}^*(x) = p^*\) and \(N_{[p]}(x)\) agree for this choice of \(x \in \sheaf O_{\G_m}\).
\end{example}

The generality with which we approached the proof of \Cref{AndosAlgebraicTheorem} not only clarifies which operations apply to the objects under consideration\footnote{This is meant in contrast to Ando's original proofs~\cite[Section 2.6]{Ando}, where he deals only with coordinates and uses uncomfortable composition operations.}, but it also applies naturally to the other kinds of orientations discussed in \Cref{ChapterSigmaOrientation}.

\begin{theorem}
Orientations \(MU[6, \infty) \to E_\Gamma\) which are \(H_\infty\) correspond to norm-coherent \index{cubical structure}cubical structures.  If \(\height{\Gamma} \le 2\), orientations \(M\String \to E_\Gamma\) which are \(H_\infty\) correspond to norm-coherent \index{Sigma structure@\(\Sigma\)--structure}\(\Sigma\)--structures. \qed
\end{theorem}

\begin{example}[{\cite[Sections 15-16]{AHSHinfty}}]
Let \(C_0\) be an elliptic curve over a perfect field of positive characteristic.  The \index{Serre--Tate theorem}Serre--Tate theorem says that the infinitesimal deformation theory of \(C_0\) is naturally isomorphic to the infinitesimal deformation theory of its \(p\)--divisible group \(C_0[p^\infty]\), and we let \(C\) be the universally deformed elliptic curve.  Our discussion of norm-coherence for Lubin--Tate groups can be repeated almost verbatim for elliptic curves, and we note further that level structures on \(\widehat C\) inject into level structures on \(C\).

We can apply these observations to \(E_{\widehat C}\), the Morava \(E\)--theory for the formal group \(\widehat C\), considered as an \index{elliptic spectrum}elliptic spectrum.  The natural orientation \[MU[6, \infty) \to E_{\widehat C}\] from \Cref{EllipticSpectraAreOriented} is determined by the natural cubical structure on \(\sheaf I(0)\), which by \Cref{Theta3IsTrivial} is \emph{uniquely} specified by the elliptic curve.  Our main new observation, then, is that the \(N_\ell\) and \(\psi_\ell^*\) constructions both convert this to a cubical structure on \(C / \ell\), and hence are forced to agree by unicity.  In turn, it follows that the \(\sigma\)--orientation is a map of \(H_\infty\)--rings.
\end{example}

\begin{remark}
In the next Lecture, we will show that Tate \(K\)--theory (cf.\ \Cref{TateKTheoryDefn}) not only arises as an elliptic spectrum, but that this endows it with a natural \(E_\infty\) structure.  From the perspective of this section, the induced \(H_\infty\) structure is controlled by quotients by finite subgroups of the Tate curve, which has been studied from various perspectives by Huan~\cite{Huan} and by Ganter~\cite{GanterStringyOpns,GanterPowerOpnsInTateKthy}.  This distinguishes it from the \(E_\infty\)--ring spectrum \(KU^{\CP^\infty_+}\), which otherwise has the same underlying ring spectrum in the homotopy category.  This distinction also arises in classical homotopy theory: the total exterior power operation in classical \(K\)--theory can be shown to give an \(E_\infty\) map to \(K^{\Tate}\) with its \(E_\infty\)--ring structure but \emph{not} to \(KU^{\CP^\infty_+}\).
\end{remark}
















\section{The spectrum of modular forms}\label{ConstructionOfTMFSection}

The introduction of the geometry of \(E_\infty\)--ring spectra has borne out a second version of the \(\sigma\)--orientation, summarized as a map of \(E_\infty\)--ring spectra \[\sigma\co M\String \to \tmf.\]  This map has \emph{extremely} good properties, not only owing to it being a map of structured ring spectra but to the object \(\tmf\) itself, not heretofore discussed.  This is one variant of the spectrum of \index{modular form!topological, \(\tmf\)}\textit{topological modular forms}, which comes about from the following daydream: according to \Cref{EllipticSpectraAreOriented} and \Cref{EllipticSpectraAreOrientedByString}, every elliptic spectrum is naturally oriented, and the system of orientations should give rise to a \(\String\)--orientation of the homotopy limit over all elliptic spectra, itself a kind of ``universal'' elliptic spectrum.  There are several delicate points to this: the limit of a diagram of rings need not be a complex-orientable ring spectrum (cf.\ the \(C_2\)--equivariant spectrum \(KU\)); this diagram is very large; and the diagram exists only in the homotopy category\footnote{Many of our elliptic spectra we produced by coupling \Cref{LEFTRealTheoremWithProof} to Brown representability, which has poor functoriality properties.} and contains loops, so ``homotopy limit'' is not automatically defined without finding a lift to a more structured context.

The goal of this Lecture is to sketch out both the ingredients and the recipe for constructing this object.  We will not prove the main theorem in full detail, as the details are so thick that they do not admit a more reasonable presentation than what Behrens has already given~\cite{BehrensConstruction}.  The idea is to make use of the obstruction theory that \(E_\infty\)--rings garner us, and to ``work locally'' on a particular class of examples where the obstruction theory is well-behaved, using these to carefully exhaust the problem.  We begin with a precise definition of what ``locally'' means in this setting:

\begin{definition}[{\cite[Definition 6.2.2.6, Section 6.5]{LurieHTT}}]
A \index{sheaf!infty sheaf@\(\infty\)--sheaf}\textit{\(\CatOf{D}\)--valued sheaf} on a site \(\CatOf{C}\) is a functor \(F\co \CatOf C \to \CatOf D\) that converts \v{C}ech diagrams of covers in $\CatOf C$ to homotopy limit diagrams in $\CatOf D$.
\end{definition}

\begin{definition}[{\cite[Remark 4.1]{GoerssTMF}}]
Let \(f\co \stack N \to \moduli{fg}\) be a flat, representable morphism of stacks.  A \index{stack!topological enrichment}\textit{topological enrichment} of \(\stack N\) is a sheaf of \(E_\infty\)--ring spectra \(\sheaf O\) on \(\stack N\) such that\footnote{In particular, \(\pi_0 \sheaf O\) recovers the structure sheaf of \(\stack N\).} \[(\pi_n \circ \sheaf O)(\text{\(U \subseteq \stack N\), affine and open}) \cong \begin{cases} (f^* \omega^{\otimes k})|_U & \text{if \(n = 2k\) is even}, \\ 0 & \text{if \(n\) is odd}. \end{cases}\]  Fix a fixed map \(f\co \stack N \to \moduli{fg}\), this has its own associated moduli problem of topological enrichments of \(f\).
\end{definition}

Our goal, then, is to outline the proof of the following theorem:

\begin{theorem}[{Goerss--Hopkins--Miller~\cite{HopkinsMiller,GoerssHopkins}; Behrens~\cite[Theorem 1.1]{BehrensConstruction}; Lurie~\cite{LurieSurveyOfEll}}]\label{UniqueTopEnrichmentOfMell}
The moduli of topological enrichments of \(\moduli{ell}\), the \index{elliptic curve!moduli}moduli of elliptic curves equipped with the \'etale topology, is nonempty.
\end{theorem}



\subsection*{The moduli of elliptic curves}

In order to give a coherent strategy for proving \Cref{UniqueTopEnrichmentOfMell}, we need to know something about the moduli of elliptic curves itself.  Recalling from \Cref{SectionEllipticCurvesAndThetaFunctions} the idea of a Weierstrass presentation of an elliptic curve, we define a general \index{elliptic curve!Weierstrass curve}Weierstrass curve to be a projective curve specified by an equation of the form \[C_a := \{y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6\},\] the universal one of which is defined over \[\moduli{Weier} = \Spec \Z[a_1, a_2, a_3, a_4, a_6][\Delta^{-1}],\] where the invertibility of the function \(\Delta\) guarantees that these curves are nonsingular.  The point at infinity in the set of projective solutions gives the curve a canonical marked point and hence the structure of an abelian variety.  The fraction \(y/x\) gives a coordinate in a neighborhood of the point at infinity, and hence Taylor expansion in this coordinate describes a map \[\moduli{Weier} \to \moduli{fgl}.\]  Just as several formal group laws give the same formal group, several Weierstrass curves present the same elliptic curve, which are related by transformations of the form
\begin{align*}
f_{\lambda,s,r,t} \co C_a & \to C_{a'}, \\
x & \mapsto \lambda^2 x + r, \\
y & \mapsto \lambda^3 y + sx + t,
\end{align*}
the universal one of which is defined over \[\moduli{Weier.trans.} = \moduli{Weier} \times \Spec \Z[\lambda^{\pm}, r, s, t].\]  The evident structure map belongs to a groupoid scheme structure on \(\moduli{ell} = (\moduli{Weier}, \moduli{Weier.trans.})\), for which there is a descended map \[\moduli{ell} \to \moduli{fg}.\]

With the moduli of elliptic curves now specified, we will construct a topological enrichment of \(\moduli{ell}\) by doing so locally, then gluing the resulting local definitions together along common subsets.  We first divide \(\moduli{ell}\) up over primes by passing to the \(p\)--completion, and then we further divide the \(p\)--complete moduli into two regions via the following result:

\begin{lemma}
Over a base field of characteristic \(p\), the \index{p divisible group@\(p\)--divisible group!elliptic curve}\index{elliptic curve!p divisible group@\(p\)--divisible group}\(p\)--divisible group of an elliptic curve is either formal of height \(2\) (called the \index{elliptic curve!supersingular}\textit{supersingular} case) or an extension of an \'etale \(p\)--divisible group of height \(1\) by a formal group of height \(1\) (called the \index{elliptic curve!ordinary}\text{ordinary} case).
\end{lemma}
\begin{proof}
The category of Dieudonn\'e modules with quasi-isogenies inverted becomes semisimple, and the simple components all take the form \[M_{m, n} = \Cart_{\overline{\F}_p} / (V^m = F^n),\] for \(m\) and \(n\) coprime~\cite{Manin}.  An \index{abelian variety}abelian variety is always isogenous to its dual~\cite[Section 7]{Milne}, and hence in this semisimple category the \index{Dieudonn\'e module}Dieudonn\'e module associated to an abelian variety decomposes into a Cartier self-symmetric sum of generators.\footnote{This is called the \index{Riemann--Manin symmetry}\textit{Riemann--Manin symmetry condition}.}  An abelian variety of dimension \(d\) has \(p\)--divisible group of height \(2d\), and Cartier duality on these simple components obeys the formula \(DM_{m,n} = M_{n,m}\), from which it follows that the only possibilities for the quasi-isogenous components of a \(p\)--divisible group associated to an elliptic curve are \(M_{1,1}\) and \(M_{1,0} \oplus M_{0,1}\).
\end{proof}

The names supersingular and ordinary are partially explained by the following result, which says that ordinary curves form the generic case and that supersingular curves are comparatively very rare:

\begin{lemma}[{\cite[Theorem V.4.1.c]{Silverman}, \cite[Corollary 4.3]{BehrensConstruction}}]
The supersingular locus of \(\moduli{ell}\) is \(0\)--dimensional.  In fact, it is the zero-locus of a polynomial of degree at most \(\lfloor (p-1)/12 \rfloor + 2\). \qed
\end{lemma}

\noindent We write \(i\co \moduli{ell}^{\ord} \to (\moduli{ell})^\wedge_p\) for the open inclusion of the ordinary locus.  We then plan to recover a topological enrichment $(\sheaf O_{\top})^\wedge_p$ of $\moduli{ell}$ by constructing the pieces of the following pullback:
\begin{center}
\begin{tikzcd}
& (\sheaf O_{\top})^\wedge_p \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & (\sheaf O_{\top})^\wedge_{\moduli{ell}^{\ss}} \arrow{d} & \sheaf O^{\ss} \arrow[equal]{l} \\
\sheaf O^{\ord} \arrow[equal]{r} & i_* i^* \sheaf O_{\top} \arrow{r} & i_* i^* \left((\sheaf O_{\top})^\wedge_{\moduli{ell}^{\ss}}\right).
\end{tikzcd}
\end{center}
This decomposition is compatible with the perspective on homotopy theory taken up in the rest of this textbook, as it is an instantiation of the \index{chromatic localization!fracture}chromatic fracture square.  The top-right node forms the \(\widehat L_2\)--local component, the bottom-left forms the \(\widehat L_1\)--local component, and the bottom-right is the gluing data: the \(\widehat L_1\)--localization of the \(\widehat L_2\)--local component.






\subsection*{The supersingular locus}

Our task in this section is to define \(\sheaf O^{\ss}\) on \(\widehat{\moduli{ell}^{\ss}}\), the infinitesimal neighborhood of the supersingular part of the topological enrichment in the larger moduli, and it suffices to specify its behavior on formal \'etale affines.  Since the moduli is itself \(0\)--dimensional, these are exactly the affine covers of the deformation spaces of the individual supersingular curves in the larger moduli \(\moduli{ell}\).  The following arithmetic result gives us a crucial reduction:

\begin{theorem}[Serre--Tate]\index{Serre--Tate theorem}
The map \(\moduli{ell} \to \moduli{pdiv}(2)\) is formally \'etale, where \(\moduli{pdiv}(2)\) is the moduli of \(p\)--divisible groups of height \(2\).\footnote{In general, \(\moduli{ab}^{d} \to \moduli{pdiv}(2d)\) is formally \'etale~\cite[Appendix 1]{KatzSTLocalModuli}.} \qed
\end{theorem}
\begin{lemma}[{\cite[Theorem 7.1.3]{BehrensLawson}}]
The deformation theory of a connected \(p\)--divisible group of height \(d\) is isomorphic to the deformation theory of the associated formal group of height \(d\). \qed
\end{lemma}

This reduces us to finding a topological enrichment for \((\moduli{fg})^\wedge_{\widehat{C}}\), i.e., a version of \index{Morava E theory@Morava \(E\)--theory}Morava \(E\)--theory.  A \emph{very} extravagant application of the resolution tools for \(E_\infty\)--ring spectra yields the following theorem, essentially owing to the very nice (i.e., formally smooth) deformation space and very nice (i.e., formally smooth) space of operations:

\begin{theorem}[{Goerss--Hopkins--Miller~\cite[Corollary 7.6--7]{GoerssHopkins}}]\label{GHMTheoremForEThy}\label{obstruction theory}
Let \(\Gamma\) be a finite height formal group over a perfect field.  The moduli of topological enrichments of \((\moduli{fg})^\wedge_\Gamma\) is homotopy equivalent to \(B\Aut \Gamma\).  An element \(\gamma\) of \(\pi_1\) of this moduli based at a specific realization \(E_\Gamma\) gives a cohomology operation \(\psi^\gamma\co E_\Gamma \to E_\Gamma\) whose behavior on \(\CP^\infty_{E_\Gamma}\) is to induce the automorphism \(\gamma\). \qed
\end{theorem}

Now we use the reduction above to extract from this a topological enrichment of \(\widehat{\moduli{ell}^{\ss}}\): the enrichment sheaf arises as the pullback of the Goerss--Hopkins--Miller sheaf along the Serre--Tate map \[\widehat{\moduli{ell}^{\ss}} = \coprod_{\text{s.s.\ \(C\)}} (\moduli{ell})^\wedge_C \xrightarrow{\text{f.\'e.}} \coprod_{\text{s.s.\ \(C\)}} (\moduli{pdiv}(2))^\wedge_{C[p^\infty]} \xleftarrow{\cong} \coprod_{\text{s.s.\ \(C\)}} (\moduli{fg})^\wedge_{\widehat C}.\]

\begin{remark}[{\cite[Section 8, Step 1]{BehrensConstruction}}]
This buys more than just a bouquet of Morava \(E\)--theories, or even the global sections \[\sheaf O^{\ss}\left(\widehat{\moduli{ell}^{\ss}}\right) = \prod_{\text{supersingular \(C\)}} E_{\widehat C}^{h\Aut C}.\]  For instance, the moduli \(\moduli{ell}^{\ss}(N)\) of supersingular elliptic curves \(C\) equipped with a \index{level structure}level--\(N\) structure\footnote{A \index{level structure}\textit{level--\(N\) structure} is a specified isomorphism \(C[N] \cong (\Z/N)^{\times 2}\), i.e., a choice of basis for the \(N\)--torsion.} forms an \'etale cover of \(\moduli{ell}^{\ss}\) whenever \(p \nmid N\), and hence this sheaf produces a spectrum \(\TMF(N)^{\ss} = \sheaf O^{\ss}(\moduli{ell}^{\ss}(N))\) satisfying \((\TMF(N)^{\ss})^{hGL_2(\Z/N)} \simeq \TMF^{\ss}\).
\end{remark}







\subsection*{The ordinary locus}

We now turn to the ordinary locus, which constitutes the bulk of the problem: remember that the supersingular locus was essentially discrete, and we are setting out to construct a sheaf, which means that we will be manufacturing a \emph{lot} of spectra.  The main tool for analyzing this situation is a specialization of the obstruction theory of Goerss--Hopkins--Miller.  First, note that completed \(p\)--adic \(K\)--homology (i.e., continuous Morava \(E\)--theory for \(\G_m\)) carries an action by \(\Aut \G_m\), and using the results of \Cref{PowerOpnsSection} this extends to an action by \(\End \G_m\) using the \(p\){\th} power operation.  In turn, the completed \(p\)--adic \(K\)--homology of an \(E_\infty\)--ring spectrum carries an action by \(\End \G_m\), which is sometimes referred to as the structure of a \index{obstruction theory!theta algebra@\(\theta\)--algebra}\textit{\(\theta\)--algebra}.  To be more explicit:
\begin{theorem}[{\cite{McClure}}]
The homotopy of a \(K(1)\)--local commutative \(K_p\)--algebra spectrum \(R\), such as \(\widehat L_1 (K_p \sm E)\), carries an extra family of ring operations \(\psi^k\) indexed on \(k \in \Z_p\), as well as a ring map \(\theta\),\footnote{If \(E_*\) is torsion-free, then \(\theta\) is redundant data, but that it's a ring map is not a redundant condition.} such that
\pushQED{\qed}
\begin{align*}
\psi^1(x) & = x, &
\psi^k (\psi^{k'} x) & = \psi^{kk'}(x), \\
\psi^p(x) & = x^p + p\theta(x), &
\psi^k(x) \cdot \psi^{k'}(x) & = \psi^{k + k'}(x). \qedhere
\end{align*}
\popQED
\end{theorem}
\noindent Goerss--Hopkins--Miller obstruction theory reverses this information flow by seeking answers to the questions:
\begin{itemize}
    \item We say that an \(E_\infty\)--ring \textit{realizes} to a \(\theta\)--algebra \(A\) when \(\widehat L_1 E \sm K_p \cong A\).  Given a \(\theta\)--algebra \(A\), what is the moduli of \(E_\infty\)--rings which realize to \(A\)?\footnote{Note that the homotopy of \(E\) itself can be recovered from that of \(R = \widehat L_1 (K_p \sm E)\) by taking fixed points for the \(\Z_p^\times\)--action, i.e., by an Adams spectral sequence.}
    \item Given a map \(f\co A \to B\) of \(\theta\)--algebras, as well as specified realizations \(R\) and \(S\) of \(A\) and \(B\) respectively, what is the moduli of maps \(R \to S\) of \(E_\infty\)--rings which realize to \(f\)?
\end{itemize}

\begin{theorem}[{Goerss--Hopkins, \(K(1)\)--locally; \cite[Theorem 7.1]{BehrensConstruction}}]
Given a map of \(\theta\)--algebras \(f\co A_* \to B_*\), the following \index{Andr\'e--Quillen cohomology}Andr\'e--Quillen cohomology groups (internal to \(\theta\)--algebras) measure various obstructions:
\begin{center}
\begin{tabular}{@{}ccc@{}} \toprule
moduli problem & existence & uniqueness \\
\midrule
a model \(E\) for \(A\) & \(H^{s \ge 3}_\theta(A_*, \Loops^{s-2} A_*)\) & \(H^{s \ge 2}_\theta(A_*, \Loops^{s-1} A_*)\) \\
a map \(E \to F\) of models & \(H^{s \ge 2}_\theta(A_*, \Loops^{s-1} B_*)\) & \(H^{s \ge 1}_\theta(A_*, \Loops^s B_*)\). \\
 \bottomrule
\end{tabular}
\end{center}
Finally, given such a map \(f\), there is a \index{Bousfield--Kan spectral sequence}spectral sequence computing the homotopy groups of the \(E_\infty\) mapping space: \[E_2^{s, t} = H^s_\theta(A_*, \Loops^{-t} B_*) \Rightarrow \pi_{-s-t}(\EinftyRings(E, F), f). \pushQED\qed\qedhere\popQED\]
\end{theorem}

\begin{remark}[{\cite[Lemmas 7.5--6]{BehrensConstruction}}]
These enhanced Andr\'e--Quillen cohomology groups can be computed using a Grothendieck-type spectral sequence, intertwining classical Andr\'e--Quillen cohomology groups for commutative rings with the extra task of checking compatibility with the \(\theta\)--algebra structure.  In practice, this means that if the underlying ring of a \(\theta\)--algebra is especially nice, it is immediately guaranteed that the relevant obstruction groups vanish.
\end{remark}

In order to apply this theorem, we need a guess as to what \(\theta\)--algebra should correspond to the completed \(p\)--adic \(K\)--theory of \(\TMF\).  The discussion in \Cref{PullingBackOverMfgVsMfgl}, \Cref{DefnChromaticHomologyThys}, and \Cref{RemovingStackinessFromSpectra} provide the foothold we need.  We expect the \(\theta\)--algebra to appear as the corner in the right-most of the following two pullback squares:

\begin{center}
\begin{tikzcd}
\cdots \arrow{r} & \Spf W_1 \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & \Spf V^\wedge_\infty \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & \Spf \Z_p \arrow["{\text{f.\'e.}}"]{d} & \\
\cdots \arrow{r} & \moduli{ell}^{\ord}(p^1) \arrow{r} & \moduli{ell}^{\ord} \arrow{r} & \moduli{fg}. &
\end{tikzcd}
\end{center}

\noindent Defined via these moduli, \(V^\wedge_\infty\) has a natural structure as a solution to a moduli problem itself: it parameterizes pairs \((C, \eta\co \G_m \xrightarrow{\cong} \widehat C)\) of ordinary elliptic curves and markings of their associated formal groups.  It carries a natural interpretation as a \(\theta\)--algebra~\cite[Equation 5.3]{BehrensConstruction}, where the interesting operation \(\psi^p\) acts by
\[
\psi^p\co \left(C, \eta\co \G_m \xrightarrow\cong \widehat C\right) \mapsto \left(C^{(p)}, \eta^{(p)}\co \G_m \to C^{(p)}\right),\]
where \(\eta^{(p)}\) is the factorization
\begin{center}
\begin{tikzcd}
\G_m[p] \arrow{r} \arrow{d} & \G_m \arrow["p"]{r} \arrow["\eta"]{d} & \G_m \arrow[densely dotted, red, "\eta^{(p)}"]{d} \\
C[p]\arrow{r} & C \arrow["p"]{r} & C^{(p)}.
\end{tikzcd}
\end{center}
Unfortunately, this \(\theta\)--algebra is not nice enough to apply the Goerss--Hopkins--Miller theorem.  In order to fix this, it becomes convenient to work at \(p \ge 5\) for simplicity, and then pass to a slightly more rigid moduli: we introduce a \index{level structure!formal}formal \((\Z/p)\)--level structure, i.e., an isomorphism \(\Z/p \cong (\widehat C)[p]\).\footnote{This partial rigidification of the formal component of the elliptic curve is related to the observations of Hopkins on the connection between homology and stacky pullbacks mentioned in \Cref{RemovingStackinessFromSpectra}~\cite[Section 3.1]{HopkinsFromSpectraToStacks}, \cite[Section 12]{Rezk512Notes}.}  This \'etale \((\Z/p)^\times\)--cover of \(\moduli{ell}^{\ord}\), known as the first \index{Igusa tower}Igusa cover, has the following exceptional property:

\begin{lemma}[{\cite[Theorem 2.9.4]{Hida}, \cite[Lemma 5.2]{BehrensConstruction}}]
For \(p \ge 5\), the moduli \(\moduli{ell}^{\ord}(p)\) is \emph{affine}. \qed
\end{lemma}

\begin{corollary}[{\cite[Theorem 7.7]{BehrensConstruction}}]
Write \(W_1\) for the associated \(\theta\)--algebra.  It has vanishing Goerss--Hopkins--Miller obstruction groups, hence realizes uniquely to an ordinary \(E_\infty\)--ring spectrum \(\TMF(p)^{\ord}\), and the action of \((\Z/p)^\times\) on the level structure enhances to a coherent \((\Z/p)^\times\)--action on \(\TMF(p)^{\ord}\). \qed
\end{corollary}

We define \(\TMF^{\ord}\), our candidate for the global sections of \(\sheaf O^{\ord}\), to be the \((\Z/p)^\times\)--fixed points of \(\TMF(p)^{\ord}\), and indeed its \(p\)--adic \(K\)--theory is \(V^\wedge_\infty\)~\cite[Lemma 7.9]{BehrensConstruction}.  More than this, it turns out that the \(\theta\)--algebra associated to any formal \'etale affine open of \(\moduli{ell}^{\ord}\) has a unique realization \emph{as an algebra under \(\TMF(p)^{\ord}\)}, and maps between such also lift uniquely~\cite[Section 7, Step 2]{BehrensConstruction}.  Altogether, this gives us the desired sheaf \(\sheaf O^{\ord}\)---and it shows that the potential complexity introduced by working with sheaves in an \(\infty\)--category does not arise in this case.

\begin{remark}
This is a common strategy: first find a topological enrichment of an affine cover of your stack of interest, then descend it to the stack itself.
\end{remark}





\subsection*{Gluing data}

We must also manufacture a map of sheaves \[i_* i^* \sheaf O_{\top} \to i_* i^* \left((\sheaf O_{\top})^\wedge_{\moduli{ell}^{\ss}}\right)\] to complete our putative pullback square.  This is rather similar to the construction of \(\sheaf O^{\ord}\) itself: we construct a candidate map \[\TMF^{\ord} \to (\TMF^{\ss})^{\ord} =: \widehat L_1 (\TMF^{\ss})\] of global sections, and then we use this to control the map of sheaves using relative Goerss--Hopkins obstruction theory.  The main results that marry algebra to topology are the following two facts about \((\TMF^{\ss})^{\ord}\).  The first is that \((\TMF^{\ss})^{\ord}\) counts as an elliptic spectrum:

\begin{lemma}[{\cite[Lemma 6.8]{BehrensConstruction}}]
There is an elliptic curve \(C^{\alg}\) over an affine \(\Spf ((V^\wedge_\infty)^{\ss})\) such that \((\TMF^{\ss})^{\ord}\) is an elliptic spectrum for this curve.
\end{lemma}
\begin{proof}[Remarks on proof]
This comes down to \index{algebraization}\textit{algebraization}: in certain cases involving formal schemes, one can guarantee the existence of extensions of the following form:
\begin{center}
\begin{tikzcd}
\Spf A \arrow{r} \arrow{d} & X \arrow{d} \\
\Spec A \arrow[densely dotted,"\exists"]{r} & Y.
\end{tikzcd}
\end{center}
Such a theorem appears here when studying the homotopy ring of \(\widehat L_1 E_{\widehat C}\), which can be calculated to be \[\pi_0 \widehat L_1 E_{\widehat C} = (\pi_0 E_{\widehat C})[u_1^{-1}]^\wedge_p,\] which is no longer easily viewed as the ring of functions on a formal scheme.  However, if the classifying map \(\Spec \pi_0 E_{\widehat C} \to \moduli{ell}\) is first algebraized, these operations of localization and completion can be performed on ordinary affine schemes.  This has its own wrinkle: algebraization is hard to understand, for one, but we are also briefly obligated to replace \(X = \moduli{ell}\) by a certain compactified moduli \(Y = \overline{\moduli{ell}}\) of cubic curves with nodal singularities allowed.
\end{proof}

\noindent This specification of a map \(\Spf ((V^\wedge_\infty)^{\ss}) \to \moduli{ell}\) gives two candidates for a \(\theta\)--algebra structure on the \(p\)--adic \(K\)--theory of \(\TMF^{\ss}\): there is the \(\theta\)--algebra structure coming from transfer of structure along the map of schemes, and there is the \(\theta\)--algebra structure coming from the shear fact that \((\TMF^{\ss})^{\ord}\) is an \(E_\infty\)--ring spectrum, and hence topology simply imbues it with such algebraic structure.

\begin{theorem}[{\cite[Theorem 6.10]{BehrensConstruction}}]
The natural \(\theta\)--algebra structure on \(\Spf ((V^\wedge_\infty)^{\ss})\) induced by the map \(\Spf ((V^\wedge_\infty)^{\ss}) \to \Spf V^\wedge_\infty\) agrees with the Goerss--Hopkins--Miller \(\theta\)--algebra structure on \(K_p (\TMF^{\ss})\). \qed
\end{theorem}

\noindent This is to be read as a recognition theorem for the \(\theta\)--algebra structure on the topological object \((\TMF^{\ss})^{\ord}\): it matches the algebraic model.  Once this is established, the Goerss--Hopkins--Miller obstructions can be shown to vanish after introducing a suitable level structure; it follows that the above map lifts to a \((\Z/p)^{\times}\)--equivariant map of the \(E_\infty\)--rings of the global sections over the moduli with level structure; this descends to a map of global sections over the original module after taking \((\Z/p)^\times\)--fixed points; and one finally produces the map of sheaves by further applications of relative obstruction theory~\cite[Section 8, Step 2]{BehrensConstruction}.

\begin{remark}[{\cite[Section 9]{BehrensConstruction}}]
\index{arithmetic fracture}Arithmetic fracture is dealt with similarly, but it is \emph{far} simpler.  Because \(\Q \otimes \TMF\) has a smooth \(\Q\)--algebra as its homotopy, the obstructions governing the version of Goerss--Hopkins--Miller for commutative \(H\Q\)--algebras vanish, letting us lift algebraic results into homotopy theory wholesale.
\end{remark}






\subsection*{Variations on these results}

\begin{remark}[{\cite[Lemma 5.2, Case 2]{BehrensConstruction}}]
At the prime \(3\), the proof of Igusa's theorem needs amplification, but the statement remains the same and the rest of the story goes through smoothly.
\end{remark}

\begin{remark}[{\cite[Lemma 5.2, Case 3; Section 8, Step 1]{BehrensConstruction}}]
At the prime \(2\), two further things go wrong: one must pass to the Igusa cover \(\moduli{ell}^{\ord}(4)\) before it becomes affine, but then the Galois group of this cover is \(C_2\), which has infinite cohomological dimension at \(2\).  Appealing to the equivalence \(KO = KU^{hC_2}\), one works with \(2\)--adic \emph{real} \(K\)--theory instead, which pre-computes the Galois action.
\end{remark}

\begin{remark}[{\cite{HopkinsK1LocalEinftyRings}, \cite{LauresK1LocalTmf}}]
There is another way to construct \(\TMF^{\ord}\) at low primes, given by a complex consisting of two \(E_\infty\) cells attached to \(\S\).  The way this is done, essentially, is by constructing a complex whose \(p\)--adic \(K\)--theory matches the expected value: first it must have the right dimension, and then the action of \(\theta\) must be corrected.
\end{remark}

\begin{remark}[{\cite[Section 7]{LawsonAbVars}}]
There is an analogous (and much easier) picture for the moduli of forms of the multiplicative group: any unordered pair of puncture points in \(\mathbb A^1\) can be used to give \(\mathbb P^1\) the unique structure of a group with identity at \(\infty\), and the associated formal group is classified by a map \(\moduli{\mathbb G_m} \to \moduli{fg}\); there is an equivalence \(\moduli{\mathbb G_m} \simeq BC_2\); and \(KU\) forms the global sections of a topological enhancement of \(\Spec \Z \to \moduli{fg}\) which descends using the complex-conjugation action to \(BC_2 \to \moduli{fg}\).
\end{remark}

\begin{remark}
With some effort, the construction of \(\sheaf O_{\top}\) outlined here extends to the compactified moduli \(\overline{\moduli{ell}}\) where Weierstrass curves with nodal singularities are allowed, i.e., where \(\Delta\) is \emph{not} inverted (as in \(y^2 + xy = x^3\)).  The resulting global sections yields a spectrum \(\Tmf\), a close cousin to \(\TMF\).  The connective truncation of that spectrum is denoted \(\tmf\), and it arises as the global sections of a topological enrichment of a stack of generalized cubics, i.e., where cuspidal singularities are also allowed (as in \(y^2 = x^3\)).
\end{remark}

\begin{remark}[{\cite{Stojanoska}}]
A topological enrichment can be thought of as an enhancement of a classical algebro-geometric object to a \textit{spectral} (or \textit{derived}) one.  This opens the door for exploring all sorts of phenomena: for instance, there is a very interesting manifestation of \index{Serre duality}Serre duality on \(\moduli{ell}\) in this enhanced setting, whose exploration is due to Stojanoska.
\end{remark}




\subsection*{Descent on homotopy}

One of the main upsides of producing a topological enrichment is that it is naturally equipped with a spectral sequence computing the homotopy of its global sections, coming from recovering \(\sheaf O(\stack N)\) as the homotopy limit of finer and finer covers of \(\stack N\).

\begin{lemma}
For \(\sheaf O\) a topological enrichment of a map \(\stack N \to \moduli{fg}\), there is a Bousfield--Kan spectral sequence \[\pushQED{\qed} E_2^{s, t} = H^s(\stack{N}; \pi_t \circ \sheaf O) \Rightarrow \pi_{t-s} \sheaf{O}(\stack{N}). \qedhere \popQED\]
\end{lemma}

\begin{lemma}
This spectral sequence is isomorphic to the \index{Adams spectral sequence}\(MU\)--Adams spectral sequence for \(\sheaf O(\stack N)\).
\end{lemma}
\begin{proof}[{Main observation in the case of \(\TMF\)}]
Consider the \index{Cech complex@\v{C}ech complex}\v{C}ech complex associated to the affine cover \[\moduli{Weier} \to \moduli{ell}.\]  We claim that the complex making up the \(E_1\)--term of the descent spectral sequence is isomorphic to the complex making up the \(E_1\)--term of the \(MU\)--Adams spectral sequence.  To illustrate, we compute the first two terms of each and compare them.
\begin{enumerate}
    \item Consider the pullback diagram of stacks
    \begin{center}
    \begin{tikzcd}
    \moduli{Weier} \arrow{r} \arrow{d} \arrow[dr, phantom, "\lrcorner", very near start] & \moduli{fgl} \arrow{d} \\
    \moduli{ell} \arrow{r} & \moduli{fg}.
    \end{tikzcd}
    \end{center}
    This is also the pullback diagram computing \(\Spec MU_* \TMF\).
    \item Now consider the pair of cubes of iterated pullbacks pictured in \Cref{HypercubesFigure}.  These compute the pullback of the cube in two different ways, producing an isomorphism \(\moduli{Weier.trans.} \cong (\moduli{fg} \times \moduli{ps}^{\mathrm{gpd}}) \times_{\moduli{fgl}} \moduli{Weier}\).
\begin{figure}
    \begin{center}
    \begin{tikzcd}[column sep=-1.2em]
    & \begin{array}{c}(\moduli{fgl} \times \moduli{ps}^{\mathrm{gpd}}) \\ \times_{\moduli{fgl}} \\ \moduli{Weier} \end{array} \arrow{rr} \arrow{ld} & & \moduli{Weier} \arrow{dd} \arrow{ld} \\
    \moduli{fgl} \times \moduli{ps}^{\mathrm{gpd}} \arrow{rr} \arrow{dd} & & \moduli{fgl} \arrow{dd} \\
    & & & \moduli{ell} \arrow{ld} \\
    \moduli{fgl} \arrow{rr} & & \moduli{fg},
    \end{tikzcd} \hspace{1em}
    \begin{tikzcd}[column sep=-1em]
    & \moduli{Weier.trans.} \arrow{rr} \arrow{dd} & & \moduli{Weier} \arrow{dd} \arrow{ld} \\
    & & \moduli{fgl} \\
    & \moduli{Weier} \arrow{rr} \arrow{ld} & & \moduli{ell} \arrow{ld} \\
    \moduli{fgl} \arrow{rr} & & \moduli{fg}. \arrow[leftarrow, crossing over]{uu}
    \end{tikzcd}
    \end{center}
    \caption{Two expressions of the same cubical pullback.}\label{HypercubesFigure}
\end{figure}
    \item[\(n\).] The general case is similar, but requires stomaching iterated pullbacks in \(n\)--cubes. \qedhere
\end{enumerate}
\end{proof}

\begin{example}
We now appeal to basic results about \(\moduli{ell} \times \Spec \Z[1/6]\) to compute \(\pi_* TMF[1/6]\) using these methods.\footnote{This is admittedly a rather elaborate way of recovering the homotopy of the \emph{complex-orientable} ring spectrum \(\TMF[1/6]\).}  After inverting \(2\) and \(3\), we can use scaling and translation transformations to complete both the cube and the square, replacing an arbitrary Weierstrass curve with a \emph{unique} one of the form \(y^2 = x^3 + c_4 x + c_6\).  This exhausts the morphisms in the groupoid \(\moduli{ell}\): the map \[\Spec \Z[c_4, c_6, \Delta^{-1}][1/6] \to \moduli{ell} \times \Spec \Z[1/6]\] is an equivalence of stacks (cf.\ \Cref{MFRemark}).  Since the quasicoherent sheaf cohomology of affines is always amplitude \(0\), this spectral sequence is concentrated on the \(0\)--line, and we recover \[\pi_* \TMF[1/6] \cong \Z[c_4, c_6, \Delta^{-1}][1/6].\]
\end{example}

\begin{remark}
The calculation of \(\pi_* \TMF\) has been completed integrally by Hopkins and Mahowald; see Bauer for detailed exposition of these results~\cite{BauerTMF}.  One of the central features of the calculation is that a power of the periodicity generator from degree \(2\) survives, so that \(\pi_* \TMF\) becomes \(576\)--periodic.  By contrast, neither \(\Tmf\) nor \(\tmf\) are periodic spectra.
\end{remark}









\section{Orientations by \texorpdfstring{\(E_\infty\)}{Eoo} maps}\label{JuvitopTalkSection}

We now recount a more modern take on the story of the \(\sigma\)--orientation which passes directly through the algebra of \(E_\infty\)--ring spectra.  Though technically intensive, our reward for grappling with this will be the modularity of the \(\String\)--orientation, enriching \Cref{WittensTheoremForBU6} to the real setting.  Luckily, most of the basic ideas are classically familiar, centering on a particular functor\index{spectrum of units, \(\gl_1\)} \[\gl_1\co \EinftyRings \to \CatOf{Spectra}.\]  This functor derives its name from two compatible sources: for one, its underlying infinite loopspace is the construction \(GL_1\) described in \Cref{LectureThomSpectra}; and secondly, it participates in an adjunction
\begin{center}
\begin{tikzcd}[column sep=4em]
\CatOf{ConnectiveSpectra} \arrow[shift left=0.3\baselineskip, "\Susp^\infty_+ \Omega^\infty"]{r} & \EinftyRings \arrow[shift left=0.3\baselineskip, "\gl_1"]{l}
\end{tikzcd}
\end{center}
analogous to the adjunction between the group of units and the group-ring constructions in classical algebra.  Its relevance to us is its participation in the theory of highly structured Thom spectra.  Let \(j\co g \to \gl_1 \S\) be a map of connective spectra, begetting a map \(J\co G \to \GL_1 \S\) of infinite loopspaces, where we have written \(G = \Loops^\infty g\).
\begin{lemma}[{\cite[Section 4]{ABGHR}, \cite[Section IV.2]{MayRingSpacesSpectra}}]
The Thom spectrum of the map \(BJ\) is presented by the pushout of \(E_\infty\)--rings\footnote{This is a kind of ``twisted group-ring'' construction.}
\begin{center}
\begin{tikzcd}
\Susp^\infty_+ \GL_1 \S \arrow["\Loops^\infty \Susp j"]{r} \arrow{d} & \Susp^\infty_+ \Loops^\infty \gl_1 \S / g \arrow{d}  \\
\S \arrow{r} & MG. \arrow[ul, phantom, "\ulcorner", very near start]
\end{tikzcd}
\end{center}
\qed
\end{lemma}

\begin{corollary}[{\cite[Section 4]{ABGHR}, \cite[Section IV.3]{MayRingSpacesSpectra}}]
There is a natural equivalence between the space of null-homotopies of the composite \[g \xrightarrow j \gl_1 \S \xrightarrow{\gl_1 \eta_R} \gl_1 R\] and the space of \(E_\infty\)--ring maps \(MG \to R\), where \(MG\) is the Thom spectrum of the stable spherical bundle classified by \(J\).\footnote{The underlying infinite loopspace \(\GL_1 R\) also plays a role in the theory of Thom isomorphisms at the level of individual bundles: \(R\)--orientations of a spherical bundle \(X \to \GL_1 \S\) biject with null-homotopies of the composite \(X \to \GL_1 \S \to \GL_1 R\).  As an example consequence, first note that the sequence of maps \[BO \xrightarrow{j} \GL_1 \S \to \GL_1 KO\] is a \(2\)--equivalence.  It thus follows that if the the tangent bundle of a manifold \(\tau\co M \to BO\) admits a Thom isomorphism in \(KO\)--homology, then there exists a lift \(\widetilde\tau\co M \to BO[3, \infty) = B\Spin\).}
\end{corollary}
\begin{proof}
Applying the mapping space functor \(\EinftyRings(-, R)\) to the pushout diagram in the Lemma, we have a pullback diagram of mapping spaces:
\begin{center}
\begin{tikzcd}
\EinftyRings(\Susp^\infty_+ \GL_1 \S, R) & \EinftyRings(\Susp^\infty_+ \Loops^\infty \gl_1 \S / g, R) \arrow{l} \\
\EinftyRings(\S, R) \arrow{u} & \EinftyRings(MG, R) \arrow{l} \arrow{u}. \arrow[ul, phantom, "\ulcorner", very near start]
\end{tikzcd}
\end{center}
We can reidentify each of the three terms to get
\begin{center}
\begin{tikzcd}
\CatOf{Spectra}(\gl_1 \S, \gl_1 R) & \CatOf{Spectra}(\gl_1 \S / g, \gl_1 R) \arrow{l} \\
\{\gl_1 \eta_R\} \arrow{u} & \EinftyRings(MG, R) \arrow{l} \arrow{u}, \arrow[ul, phantom, "\ulcorner", very near start]
\end{tikzcd}
\end{center}
hence \(\EinftyRings(MG, R)\) appears as the fiber at \(\gl_1 \eta_R\) of the restriction map, which coincides with the space of nullhomotopies as claimed.
\end{proof}

\begin{corollary}[{\cite[Section 2.3]{AHR}}]
There exist \(E_\infty\) maps \(Mj \to R\) if and only if \(\gl_1 \eta_R \circ j\) is null-homotopic.  If this is the case, then the set \[\EinftyRings(Mj, R)\] is a torsor for \([\Susp g, \gl_1 R]\). \qed
\end{corollary}

Ando, Hopkins, and Rezk~\cite{AHR} have used this presentation to understand the mapping space \(\EinftyRings(M\String, \tmf)\).  In this Lecture, we will use this same technology to understand the mapping space \[\EinftyRings(M\Spin, KO_{(p)}),\] which proceeds along entirely similar lines but is a \emph{considerably} simpler computation.\footnote{Ando, Hopkins, and Rezk also do \(\EinftyRings(M\Spin, KO)\) as a warm-up computation~\cite[Section 7]{AHR}, and we are further \(p\)--localizing that result so as not to have to think about arithmetic fracture.  Working arithmetically globally should be an easy exercise for the reader.}  The approach to this computation is to mix the presentation above with \index{chromatic localization!fracture}chromatic fracture applied to the target:
\begin{center}
\begin{tikzcd}
M\Spin \arrow[densely dotted]{r} \arrow[bend left=15]{rr} \arrow{rrd} \arrow{rd} & KO_{(p)} \arrow{r} \arrow[crossing over]{d} \arrow[rd, phantom, "\lrcorner", very near start] & KO_p \arrow{d} \\
& \Q \otimes KO \arrow{r} & \Q \otimes KO_p.
\end{tikzcd}
\end{center}
So, we seek a pair of \(E_\infty\)--ring maps into the rationalization and the \(p\)--completion of \(KO\) which agree on the \(p\)--local ad\`eles, which involves understanding not just the mapping spaces but also the pushforward maps between them.





\subsubsection{Rational orientations}

We begin with the two rational nodes in the pullback diagram.  As a first approximation to our goal, consider the problem of giving a complex orientation \(MU \to \Q \otimes R\) of a rational ring spectrum \(\Q \otimes R\).  There is an automatic such orientation granted by
\begin{center}
\begin{tikzcd}
MU \arrow[densely dotted, "D"]{r} \arrow{rd} & \Q \otimes R \\
\S \arrow[crossing over]{ru} \arrow{r} & H\Q \arrow{u}
\end{tikzcd}
\end{center}
constructed out of the unit map \(\S \to MU\), the unit map \(\S \to \Q \otimes R\), the rationalization map \(\S \to \Q \otimes \S \cong H\Q\), and the standard additive orientation \(MU \to H\Q\) of an Eilenberg--Mac Lane spectrum.  When \(\EinftyRings(MU, T)\) is nonempty, it is a torsor for \([bu, \gl_1 T]\), and since we have a preferred orientation \(D\) we thus have isomorphisms
\begin{align*}
\pi_0 \EinftyRings(MU, \Q \otimes R) & \xleftarrow{\cong} [bu, \gl_1 \Q \otimes R] \\
& \xleftarrow{\cong} [bu, \Q \otimes \gl_1 R] \\
&\xrightarrow{\cong} [\Q \otimes bu, \Q \otimes \gl_1 R],
\end{align*}
the last of which is specified by a sequence \((t_{2k})_{k \ge 1} \in \pi_* (\Q \otimes \gl_1 R)\).  The role played by the sequence \((t_{2k})\) is to perturb the Thom class.

\begin{lemma}[{\cite[Proposition 3.12]{AHR}}]
Write \(x\) for the Thom class of \(\L\) on \(\CP^\infty\) in \((\Q \otimes R)\)--cohomology as furnished by the automatic orientation \(D\).  The Thom class associated to some other orientation of \(\Q \otimes R\) is tracked by a \index{characteristic series}difference series \(x / \exp_F(x)\), and the sequence \((t_k)\) above is expressed by \(x / \exp_F(x) = \exp(\sum_k t_k/k! \cdot x^k)\).
\end{lemma}
\begin{proof}[Proof sketch]
Let \(v^k\co S^{2k} \to BU\) be the \(k\){\th} power of the class \(\L\), so that it comes from a restriction \[S^{2k} \to (\CP^\infty)^{\sm k} \xrightarrow{\L^{\boxtimes k}} BU.\]  The Thom class for this bundle comes from the top Chern class, which is the top coefficient in the product of total Chern classes applied to the individual bundles.  Following the usual formulas shows the map \(v^k\) to behave on homotopy by multiplication by \((-1)^k t_k\).
\end{proof}

Now we move away from \(MU\).  There are three directions for generalization: connective orientations, real orientations, and non-complex targets.
\begin{enumerate}
\item The rational analysis of Ando--Hopkins--Strickland identifies the set \[[BU[2k, \infty), \Q \otimes R]\] with \(k\)--variate symmetric multiplicative \(2\)--cocycles over \(R\), every one of which arises as \(\delta^1\) repeatedly applied to a univariate series.  In homotopy theoretic terms, this means that every \(MU[2k, \infty)\)--orientation of a rational spectrum factors through an \(MU\)--orientation.
\item The cofiber sequence \(kO \to kU \to \Susp^2 kO\) splits rationally, using the idempotents \(\frac{1 \pm \chi}{2}\) on \(kU\).  Accordingly, \(MU\)--orientations of rational spectra that factor through \(M\SO\)--orientations have an invariance property under \(\chi\): \(-[-1](x) = x\), corresponding to the idempotent factor \(+\).  This pattern continues for the characteristic series of connective orientations.
\item This same cofiber sequence and idempotent splitting also tells us that rational \(KU\)--cohomology classes in the image of \(KO\)--cohomology are \(\chi\)--invariant, i.e., they belong to the \(-\) factor.
\end{enumerate}

Our main example is the usual orientation \(MU \to KU\) that selects the formal group law \(x + y - xy\).  This is associated to the difference Thom class \(x / (\mathrm{e}^x - 1) = x / \exp_{\G_m}(x)\).  To make this difference \([-1]\)--invariant (and hence give a complex-orientation of \(\Q \otimes KO\)), we use the averaged exponential class \((\mathrm{e}^{x/2} - 1) - (\mathrm{e}^{-x/2} - 1)\).\footnote{Incidentally, this is equal to \(2\operatorname{sinh}(x/2)\).}  In turn, we use the Lemma to calculate the behavior on homotopy of the associated orientation:\footnote{This comes out of applying \(\mathrm{d}\log\) to the fraction.}\index{Bernoulli!number} \[\frac{x}{\mathrm e^{x/2} - \mathrm e^{-x/2}} = \exp\left(-\sum_{k=2}^\infty \frac{B_k}{k} \cdot \frac{x^k}{k!}\right).\]  Finally, we calculate the effect of the orientation on the second half of the factorization \[M\SU \to M\Spin \to KO,\] again using the relevant idempotent, which has the effect of halving the coefficients in the characteristic series: \(-\frac{B_k}{2k}\).\footnote{While we're here, you might want to observe that elements in \([bu, \gl_1 R]\) push forward to elements in \([bu, \gl_1 \Q \otimes R]\) which do not disturb the denominators of the elements \(t_k\).  (On the other hand, the ``Miller invariant'' associated to a rational ring spectrum is \emph{zero}, because arbitrary elements in \([bu, \gl_1 \Q \otimes R]\) can completely destroy the denominators.)}

This accounts for both of the mapping sets \[\EinftyRings(M\Spin, \Q \otimes KO), \quad \EinftyRings(M\Spin, \Q \otimes KO_p).\]  The set of rational characteristic series includes into the set of ad\`elic characteristic series as the subset with rational coefficients.




\subsubsection{Finite place orientations}\label{FinitePlaceOrientationsSubsection}

We want to understand \(\EinftyRings(M\Spin, KO_p)\) and the map \[\EinftyRings(M\Spin, KO_p) \to \EinftyRings(M\Spin, \Q \otimes KO_p).\]  Here is the initial set-up:
\begin{center}
\begin{tikzcd}[column sep=3em,
execute at end picture={
    \coordinate (glS) at (glS.center);
    \coordinate (Cj) at (Cj.center);
    \coordinate (glKOp) at (glKOp.center);
    \fill[opacity=0.3] 
        (glS) -- (Cj) -- (glKOp) -- cycle;
    \node[fill=white, fill opacity=0.33, text opacity=1] (A) at ([shift={(225:0.75)}]Cj) {\scriptsize \(A\)};
}]
\spin \arrow{r}[description]{j} & |[alias=glS]| \gl_1 \S \arrow{r} \arrow{rd}[description]{\gl_1 \eta_{KO_p}} & |[alias=Cj]| Cj \arrow{d} \\
& & |[alias=glKOp]| \gl_1 KO_p.
\end{tikzcd}
\end{center}
We are looking to understand the space of filler diagrams \(A\) (i.e., vertical maps with choice of homotopy of the precomposite to \(\gl_1 \eta_{KO_p}\)).  Notice first that there is a natural cofiber sequence to be placed on the bottom row:
\begin{center}
\begin{tikzcd}[column sep=0.7em,
execute at end picture={
    \coordinate (glS) at (glS.center);
    \coordinate (Cj) at (Cj.center);
    \coordinate (glKOp) at (glKOp.center);
    \fill[black,opacity=0.2] 
        (glS) -- (Cj) -- (glKOp) -- cycle;
    \node[fill=white, fill opacity=0.33, text opacity=1] (A) at ([shift={(225:0.75)}]Cj) {\scriptsize \(A\)};
}]
\spin \arrow{r}[description]{j} \arrow[very thick]{rd} & |[alias=glS]| \gl_1 \S \arrow{r} \arrow[very thick]{d} \arrow{rd}[description]{\gl_1 \eta_{KO_p}} & |[alias=Cj]| Cj \arrow{d} \\
& \Susp^{-1} \Q/\Z \otimes \gl_1 KO_p \arrow{r} & |[alias=glKOp]| \gl_1 KO_p \arrow{r} & \Q \otimes \gl_1 KO_p \arrow{r} & \Q/\Z \otimes \gl_1 KO_p.
\end{tikzcd}
\end{center}
There is a canonical bolded vertical lift of \(\gl_1 \eta_{KO_p}\) since \(\gl_1 \S\) is a torsion spectrum, and this precomposes with \(j\) to give the diagonal map.  Notice now that selecting a filler triangle \(A\) gives a commuting square with choice of homotopy and that \([\gl_1 \S, \Q \otimes \gl_1 KO_p] = 0\), and hence we would get a natural map (and natural homotopy) off of the homotopy cofibers:
\begin{center}
\begin{tikzcd}[column sep=0.7em,
execute at end picture={
    \coordinate (glS) at (glS.center);
    \coordinate (Cj) at (Cj.center);
    \coordinate (glKOp) at (glKOp.center);
    \fill[black,opacity=0.2] 
        (glS) -- (Cj) -- (glKOp) -- cycle;
    \node[fill=white, fill opacity=0.33, text opacity=1] (A) at ([shift={(225:0.75)}]Cj) {\scriptsize \(A\)};
}]
\spin \arrow{r}[description]{j} \arrow{rd} & |[alias=glS]| \gl_1 \S \arrow{r} \arrow{d} \arrow{rd}[description]{\gl_1 \eta_{KO_p}} & |[alias=Cj]| Cj \arrow[very thick]{d}[description]{B} \arrow{r} & b\spin \arrow{r} \arrow{rd} \arrow[very thick]{d}[description]{C}& b\gl_1 \S \arrow{d} \\
& \Susp^{-1} \Q/\Z \otimes \gl_1 KO_p \arrow{r} & |[alias=glKOp]| \gl_1 KO_p \arrow{r} & \Q \otimes \gl_1 KO_p \arrow{r} & \Q/\Z \otimes \gl_1 KO_p,
\end{tikzcd}
\end{center}
where \(C\) is a map making the triangle it belongs to commute.  This all gives a function assigning \(A\) to \(B\) and \(A\) to \(C\) (and, in fact, the latter assignment factors through the former).

In order to show nonconstructively that the set of \(A\)s is nonempty, we might try to discern that \(\gl_1 \eta_{KO_p} \circ j \in [\spin, \gl_1 KO_p]\) is zero by demonstrating something about the mapping set \([\spin, \gl_1 KO_p]\) itself.  We proceed by a sequence of quite improbable steps, beginning with the following Theorem original to Ando--Hopkins--Rezk:
\begin{theorem}[{\cite[Theorem 4.11]{AHR}}]
Let \(R\) be a \(E(d)\)--local \(E_\infty\)--ring spectrum, and set \(F\) to be the fiber \[F \to \gl_1 R \to L_d \gl_1 R,\] known as the \index{discrepency spectrum}\textit{discrepency spectrum}.  Then \(\pi_* F\) is torsion and \(F\) satisfies the coconnectivity condition \(F \simeq F(-\infty, d]\). \qed
\end{theorem}

\noindent It follows that \(\gl_1 KO_p \to L_1 \gl_1 KO_p\) is a \(1\)--connected map, and hence \[[\spin, \gl_1 KO_p] = [\spin, L_1 \gl_1 KO_p].\]  In fact, we can even pass to the \(K(1)\)--localization, if we digress for a moment to introduce Rezk's \index{Rezk logarithm}logarithmic cohomology operation.

\begin{lemma}[{\cite[Theorem 1.1]{Kuhn}}]
For each \(d \ge 1\), the \index{Bousfield--Kuhn functor}\textit{Bousfield--Kuhn functor} is a functor \(\Phi_d\co \CatOf{Spaces}_{*/} \to \CatOf{Spectra}\) which commutes with finite limits, is insensitive to upward truncation, and which evaluates on infinite loopspaces to give \(\Phi_d(\Loops^\infty X) = \widehat L_d X\).\footnote{Importantly, \(\Phi_d\) does \emph{not} care about the actual infinite loopspace structure on \(\Loops^\infty X\), just that it has \emph{some} lift to a spectrum \(X\).}\footnote{There is also a version of this theorem for \(d = 0\), but since rational localization has no periodic behavior the results as not nearly as striking.} \qed
\end{lemma}

\begin{definition}[{\cite[Section 3]{RezkLogarithm}}]
The natural equivalence \[(\GL_1 R)[1, \infty) \to (\Loops^\infty R)[1, \infty)\] gives rise to a map \(\ell_d\) as in the diagram
\begin{center}
\begin{tikzcd}
& \Phi_d (\GL_1 R)[1, \infty) \arrow["\simeq"]{r} & \Phi_d (\Loops^\infty R)[1, \infty) \\
\gl_1 R \arrow{r} \arrow[bend right=15, "\ell_d" description]{rr} & \widehat L_d \gl_1 R \arrow["\simeq"]{r} \arrow[equal, crossing over]{u} & \widehat L_d R \arrow[equal, crossing over]{u} .
\end{tikzcd}
\end{center}
\end{definition}

\begin{remark}
Applying the logarithm to the corners in the height \(1\) chromatic fracture square yields the following identification:
\begin{center}
\begin{tikzcd}
& L_1 \gl_1 R \arrow{rr} \arrow{dd} \arrow[rrdd, phantom, "\lrcorner", very near start] & & \widehat L_1 R \arrow{dd} \\
L_1 \gl_1 R \arrow[crossing over]{rr} \arrow{dd} \arrow[equal]{ru} \arrow[rrdd, phantom, "\lrcorner", very near start] & & \widehat L_1 \gl_1 R \arrow{ru}[description]{\ell_1} \\
& \widehat L_0 R \arrow{rr} & & \widehat L_0 \widehat L_1 R \\
\widehat L_0 \gl_1 R \arrow{rr} \arrow{ru}[description]{\ell_0} & & \widehat L_0 \widehat L_1 \gl_1 R \arrow{ru}[description]{\widehat L_0 \ell_1} \arrow[crossing over, leftarrow]{uu} .
\end{tikzcd}
\end{center}
The front and back faces are connected by logarithms of \emph{different} heights---or, equivalently, the bottom horizontal arrow of the back face is \emph{twisted} from the usual chromatic fracture presentation of \(L_1 R\).  The identification of this map is the usual sticking point in this approach.
\end{remark}

\begin{theorem}[{\cite[Theorem 1.9]{RezkLogarithm}}]
For \(R\) a \(K(1)\)--local \(E_\infty\)--ring with \(\pi_0 R\) torsion--free, the map \(\pi_0 \ell_1\co \pi_0 R^\times \to \pi_0 R\) is given by the formula\footnote{The analogue of this formula for \(E_\Gamma\) (but not an arbitrary \(K(d)\)--local \(E_\infty\)--ring spectrum) is given in \cite[Subsection 1.10]{RezkLogarithm}.} \[\pushQED{\qed} \ell_1(x) = \frac{1}{p} \log\left(\frac{x^p}{\psi^p x}\right) = \sum_{k=1}^\infty \frac{p^{k-1}}{k} \left(\frac{\theta(x)}{x^p}\right)^k. \qedhere \popQED\]
\end{theorem}

\begin{corollary}
The natural map \(L_1 \gl_1 KO_p \to \widehat L_1 \gl_1 KO_p\) is a connective equivalence.
\end{corollary}
\begin{proof}
We specialize the above square to \(R = KO_p\):
\begin{center}
\begin{tikzcd}
& & & KO_p \arrow{dd} \\
L_1 \gl_1 KO_p \arrow{rr} \arrow{dd} \arrow[rrdd, phantom, "\lrcorner", very near start] & & \widehat L_1 \gl_1 KO_p \arrow{ru}[description]{\ell_1} \\
& L_0 KO_p[4, \infty) \arrow{rr} & & L_0 KO_p \\
L_0 \gl_1 KO_p \arrow{rr} \arrow{ru}[description]{\ell_0} & & L_0 \widehat L_1 \gl_1 KO_p. \arrow{ru}[description]{\ell_1} \arrow[crossing over, leftarrow]{uu}
\end{tikzcd}
\end{center}
The behavior of the back horizontal map is determined by Rezk's formula for the logarithm.  It acts by some nonzero number in every positive degree, hence the fiber has the form \(\prod_{k=-\infty}^0 \Susp^{4k-1} H\Q\).  Since the front face is a fiber square, this is also a calculation of the fiber of the map in the Lemma statement.\footnote{As a corollary of this same method, the Rezk logarithm for \(R = KU^\wedge_p\) gives an equivalence \(\gl_1 KU^\wedge_p[3, \infty) \to KU^\wedge_p[3, \infty)\).  This was previously known by nonconstructive methods to Adams and Priddy~\cite[Corollary 1.4]{AdamsPriddy}.}
\end{proof}

As a consequence, we have identifications \[\gl_1 \eta_{KO_p} \circ j \in [\spin, \gl_1 KO_p] \cong [\spin, L_1 \gl_1 KO_p] \cong [\spin, \widehat L_1 \gl_1 KO_p].\]  A direct application of the Rezk logarithm replaces \(\widehat L_1 \gl_1 KO_p\) with \(KO_p\), and the \(K(1)\)--localization of \(\spin\) recovers \(\Susp^{-1} KO_p\).  Altogether, this identifies \[\spin \xrightarrow{j} \gl_1 \S \xrightarrow{\gl_1 \eta_{KO_p}} \gl_1 KO_p\] with a point in the mapping set \([\Susp^{-1} KO_p, KO_p]\)---and we mark this as a point where we would like to understand the space of \(KO_p\)--operations.

We claim also that the kernel of the assignment \(A \mapsto C\) is easy to understand: two fillers \(A\) are related by an element of \([b\spin, \gl_1 KO_p]\), and their corresponding \(C\)s are related by the corresponding element of \([b\spin, \Q \otimes \gl_1 KO_p]\).  This set is rational, hence factors through the rationalization of \([b\spin, \gl_1 KO_p]\) where it must already be null, and hence it is a torsion element of \([b\spin, \gl_1 KO_p]\).  Meanwhile, the same argument as above identifies \[[b\spin, \gl_1 KO_p] = [KO_p, KO_p],\] which we mark as a second point where we would like to understand the space of \(KO_p\)--operations.  In particular, if we were to find the group of degree-preserving \(KO_p\)--operations to be torsion-free, then the assignment \(A \mapsto C\) would be \emph{injective}.

We would like to understand the behavior of \(C\) on homotopy based on some data about \(A\).  This serves two purposes: there is the necessary condition that the triangle formed by \(C\) and the canonical map \(b\spin \to \Q / \Z \otimes \gl_1 KO_p\) commute, and then also the composite \[b\spin \xrightarrow{C} \Q \otimes \gl_1 KO_p \to (\gl_1 (\Q \otimes KO_p))[1, \infty)\] describes the map into the ad\`elic component.  In order to gain access to \(C\), first notice that we can postcompose \(B\) with the localization map off of \(\gl_1 KO_p\) as in \Cref{MainAHRDiagram}.\footnote{Importantly, and differently from what every source says, this isn't a map of cofiber sequences and so there is no commuting map with signature \(\widehat L_1 b\spin \to \Q \otimes \widehat L_1 \gl_1 KO_p\).}  This gives a new map \(B'\co KO_p \to KO_p\)---a third reason to understand \(KO_p\)--operations.

We are now in a position to compute the action of \(C\) on a homotopy class in \(\pi_* b\spin\) by chasing through the following steps:
\begin{enumerate}
    \item We push such a class forward to \(\widehat L_1 b\spin \simeq KO_p\) along the localization map.
    \item We then pull it back to \(\widehat L_1 Cj \simeq KO_p\) along \(KO_p \xrightarrow{1 - \psi^c} KO_p\), which acts by multiplication by \((1 - c^k)\) on \(\pi_{4k}\).
    \item We push it down along \(B'\) to \(\widehat L_1 \gl_1 KO_p \simeq KO_p\), which acts by an unknown factor.
    \item We include it into the rational component of \(\Q \otimes \widehat L_1 gl_1 KO_p\), using the fact that \(\pi_* \widehat L_1 \gl_1 KO_p\) is torsion--free.
    \item Finally, we pull it back to \(\Q \otimes \gl_1 KO_p\) along the logarithm \(\ell_1\), which acts by multiplication by \((1 - p^{k-1})\) using Rezk's \(K(1)\)--local formula.\footnote{The formula for the logarithm in nonzero degrees comes from thinking of the logarithm as a \emph{natural transformation} and applying it to the mapping set \(\ell\co \gl_1 KO^0(S^{2n}) \to KO^0(S^{2n})\).}
\end{enumerate}
The effect of this sequence of steps is \[t_{4k} = (1 - c^k)^{-1} b_{4k} (1 - p^{k-1})^{-1},\] where \(t_{4k}\) and \(b_{4k}\) are the effects on \(\pi_{4k}\) of the maps \(C\) and \(B'\) respectively.  In the course of this proof, we are using the fact that division in the ring \(\Z_p\) is unique when it is possible---the more responsible-looking equation to write is \[b_{4k} = (1 - c^k) t_{4k} (1 - p^{k-1}).\]

\begin{sidewaysfigure}
\centering
\begin{tikzcd}[column sep=0em,
execute at end picture={
    \coordinate (glS) at (glS.center);
    \coordinate (Cj) at (Cj.center);
    \coordinate (glKOp) at (glKOp.center);
    \fill[black,opacity=0.2] 
        (glS) -- (Cj) -- (glKOp) -- cycle;
    \node[fill=white, fill opacity=0.33, text opacity=1] (A) at ([shift={(225:1.5)}]Cj) {\scriptsize \(A\)};
}]
& & & \widehat L_1 \S \arrow{rr} \arrow[equal]{d} & & KO_p \arrow[equal]{d} \arrow["1 - \psi^c"]{rr} & & KO_p \arrow[equal]{d} \\
& & & \widehat L_1 \gl_1 \S \arrow{rr} & & \widehat L_1 Cj \arrow[very thick, "B'" near start]{dd} \arrow[very thick]{rr} & & \widehat L_1 b\spin \\
\spin \arrow{rr}[description]{j} \arrow{rrdd} & & |[alias=glS]| \gl_1 \S \arrow{rr} \arrow{dd} \arrow{ru} \arrow{rrdd}[description]{\gl_1 \eta_{KO_p}} & & |[alias=Cj]| Cj \arrow{ru} \arrow{dd}[description]{B} \arrow[crossing over]{rr} & & b\spin \arrow[very thick]{ru} \arrow[crossing over]{rr} \arrow[bend left=20]{rrdd} & & b\gl_1 \S \arrow{dd} \\
& & & & & \widehat L_1 \gl_1 KO_p \arrow[very thick]{rr} & & \Q \otimes \widehat L_1 \gl_1 KO_p \\
& & \Susp^{-1} \Q/\Z \otimes \gl_1 KO_p \arrow{rr} & & |[alias=glKOp]| \gl_1 KO_p \arrow{ru} \arrow{rr} & & \Q \otimes \gl_1 KO_p \arrow[very thick]{ru} \arrow{rr} \arrow[densely dotted, leftarrow, crossing over, "C"' near end]{uu} & & \Q/\Z \otimes \gl_1 KO_p.
\end{tikzcd}
\caption{A diagram showing the interconnections among the main components of the \(p\)--primary part of the Ando--Hopkins--Rezk argument.}\label{MainAHRDiagram}
\end{sidewaysfigure}

Now, finally, the diagonal map \(b\spin \to \Q/\Z \otimes \gl_1 KO_p\) becomes relevant.  To check the commutativity of the triangle with \(C\), we need only compare the results of the composite on homotopy since the map \(C\) targets a rational spectrum and hence is determined its effect on homotopy.  The following invariance property makes this map accessible:

\begin{theorem}[{\cite[Proposition 3.15 and Corollary 3.16]{AHR}}]
For any \(A_\infty\)--orientation \(\phi\co MU \to R\) of an \(A_\infty\)--ring spectrum \(R\), the denominators of the characteristic series associated to \(\Q \otimes \phi\) compute the behavior of the map \(\pi_* BU \to \Q / \Z \otimes GL_1 R\). \qed
\end{theorem}

\begin{corollary}
The numbers \(t_{4k}\) describing the effect of \(C\) satisfy the congruences \[t_{4k} \equiv -\frac{B_k}{2k} \pmod{\Z}.\]
\end{corollary}
\begin{proof}[Proof sketch]
The Todd orientation \(MU \to KU\) is known to be \(A_\infty\)~\cite[Theorem V.4.1]{EKMM}, and the characteristic series of the Todd orientation has coefficients \(B_k\).  The extra division by \(2\) is picked up by studying the map \(\pi_* B\SU \to \pi_* B\Spin\) and the map \(\pi_* KO \to \pi_* KU\).
\end{proof}

We have thus identified the legal fillers \(C\) as those sequences of rational numbers \(t_{4k}\) satisfying conditions:
\begin{enumerate}
    \item \(t_{4k}\) has the correct denominators: for \(k \ge 1\), \(t_{4k} \equiv -B_k/(2k) \pmod{\Z}\).
    \item \(b_{4k}\) is the effect on homotopy of some map \(B'\co KO_p \to KO_p\).
\end{enumerate}


\subsubsection{Stable \(KO\) operations}
\newcommand{\cts}{\mathrm{cts}}

We have identified three points where we want to understand the collection of stable \(KO_p\) operations (which we will abbreviate to \(KO\), since in this subsection we are concerned only with the \(p\)--adic case).  Although much of the main text of this book has been concerned with this sort of subject, this does not appear to be so immediately accessible: we want operations rather than cooperations, and \(KO\) is \emph{not} a complex-orientable ring spectrum.  It is close to one, though, and we gain access to it through familiar approximation.

The easy initial calculation is the continuous \(p\)--adic \(KU\)--homology \(KU^\vee KU\) can be computed to be \(KU^\vee KU = \CatOf{Spaces}(\Z_p^\times, \Z_p)\), the ring of \(\Z_p\)--valued functions\footnote{\emph{Functions}, not homomorphisms!} on \(\Z_p^\times\) which are continuous for the adic topologies on the domain and the target.  This comes out of the stable cooperations of \index{Landweber flat}Landweber flat homology theories discussed in \Cref{DefnChromaticHomologyThys}, where we showed that \(E_\Gamma\) has cooperations given by the ring of functions on the pro-\'etale group scheme \(\Aut \Gamma\).  For \(\Gamma = \G_m\), this group scheme \(\Aut \G_m\) is constant at \(\Z_p^\times\), so that \(KU^\vee KU\) is the ring of \(\Z_p\)--valued functions on \(\Z_p^\times\).  Turning to cohomology, it follows by the universal coefficient spectral sequence that \(KU^0 KU = \CatOf{Groups}(\CatOf{Spaces}(\Z_p^\times, \Z_p), \Z_p)\) and that \(KU^1 KU = 0\).  These correspondences behave as follows~\cite{AHRMoments}:
\begin{enumerate}
    \item The \index{Kronecker pairing}Kronecker pairing \[\S^0 \xrightarrow{c} KU \sm KU \xrightarrow{1 \sm f} KU \sm KU \xrightarrow{\mu} KU\] is computed by the evaluation pairing \[(c \in KU^\vee KU, f \in K^0 KU) \mapsto f(c).\]
    \item The stable operation \(\psi^\lambda\) attached to \([\lambda] \in \Aut \G_m\) is evaluation at \(\lambda\).
    \item The stable cooperation \(v^{-k} \sm v^k \in \pi_0 KU \sm KU\) corresponds to the polynomial function \(x \mapsto x^k\), as justified by the computation \[\operatorname{ev}_{\lambda}(v^{-k} \sm v^k) = \frac{\psi^\lambda v^k}{v^k} = \frac{\lambda^k v^k}{v^k} = \lambda^k.\]
\end{enumerate}

\noindent These last two facts mean that the behavior of a stable operation on homotopy is identical information to the values of a functional \(f\) on the standard polynomial functions \(x^k\).  We record this algebraic model as follows:
\begin{lemma}
For any \(N \ge 0\), the assignment \[\CatOf{Groups}(\CatOf{Spaces}(\Z_p^\times, \Z_p), \Z_p) \xrightarrow{(f(x \mapsto x^k))_k} \prod_{k \ge N} \Z_p\] is injective.  A sequence \((x_k)\) is said to be a \index{Kummer sequence@K\"ummer sequence}\textit{K\"ummer sequence} when it lies in this image.\footnote{A bit more explicitly: \((x_k)\) is K\"ummer when for all \(h(x) = \sum_{k=N}^n a_k x^k \in \Q[x]\) we have \(\sum_{k=N}^m a_k x_k \in \Z_p\).} \qed
\end{lemma}

\begin{remark}
An interesting feature of the Lemma is the auxiliary index \(N\), which is \emph{not} part of the property of being K\"ummer.  In \(p\)--adic geometry, this is reflected by the \(p\)--adic convergence of the sequence \[d + (p-1)p^r \xrightarrow{r \to \infty} d,\] and hence the continuous reconstruction property \[x_d = \lim_{r \to \infty} x_{d + (p-1)p^r}.\]  In homotopy theory, this is reflected by the \(p\)--adic reconstruction property \[KU \sm KU[2k, \infty) \simeq KU \sm KU.\]
\end{remark}

\begin{remark}
With this computation in hand, the spectrum of \(p\)--local cooperations \(KU_{(p)} \sm KU_{(p)}\) can be recovered from arithmetic fracture, as can the global operations \(KU \sm KU\).  The answer is quite similar: \(\pi_0 KU \sm KU\) is populated by rational polynomials which evaluate to integers on all integer inputs, called \index{numerical polynomials}\textit{numerical polynomials}.
\end{remark}

To pass from \(KU\) to \(KO\), we begin with the \index{Tate vanishing}Tate trick~\cite{ClausenMathew,GreenleesSadofsky,HoveySadofsky}:
\begin{align*}
KU \sm KO & \simeq KU \sm (K^{hC_2}) \tag{\(KO\) is a homotopy fixed point spectrum} \\
& \simeq KU \sm (KU_{hC_2}) \tag{Tate objects vanish \(K(1)\)--locally} \\
& \simeq (KU \sm KU)_{hC_2} \tag{homotopy colimits pull past smash products} \\
& \simeq (KU \sm KU)^{hC_2}, \tag{Tate objects vanish \(K(1)\)--locally}
\end{align*}
so that \(\pi_0 KU \sm KO = \CatOf{Spaces}(\Z_p^\times / C_2, \Z_p)\).  Taking fixed points again, we then also have \(\pi_* KO \sm KO = \CatOf{Spaces}(\Z_p^\times / C_2, KO_*)\), and \(KO^* KO\) is the \(KO_*\)--linear dual.  From this we gain the computations
\begin{align*}
[\Susp^{-1} KO, KO] & = 0, &
[KO, KO] & \cong \CatOf{Groups}(\CatOf{Spaces}(\Z_p^\times / C_2, \Z_p), \Z_p),
\end{align*}
where the isomorphism is given by sending an operation $f\co KO \to KO$ to the K\"ummer sequence $(f(v^k)/v^k)_k \in \pi_0 KO = \Z_p$.  We additionally see that \([KO, KO]\) torsion-free, which altogether accounts for all of our outstanding claims.


\subsubsection{Mazur's construction of Kubota--Leopoldt \(p\)--adic \(L\)--functions}

Having learned enough about \(KO\)--operations to justify the program enacted in the previous subsections, we now need to show that there exist sequences of \(p\)--adic integers satisfying those criteria.

\begin{theorem}[{\cite{Mazur}}]
For any auxiliary \(c \in \Z_p^\times\), there is a functional \(f_c\) satisfying\footnote{\[\text{Explicitly,\;} f_c(h) = \int_{\Z_p^\times} h(x) \mathrm d\mu_c = \lim_{r \to \infty} \frac{1}{p^r} \sum_{\substack{0 \le i < p^r \\ p \nmid i}} \int_i^{ci} \frac{h(t)}{t} \mathrm dt.\]  It also satisfies the normalizing property \(\int_{\Z_p^\times} \mathrm d\mu_c = \frac{1}{p} \log(c^{p-1})\).}\footnote{With considerable effort, this output can be halved~\cite[Section 10.3]{AHR}.} \[f_c(x^{k \ge 1}) = \frac{-B_k}{k}(1 - p^{k-1})(1 - c^k).  \pushQED\qed \qedhere \popQED\]
\end{theorem}

\noindent This Theorem is stated in exactly the generality it was originally proven, and so you might wonder why Mazur had already proven \emph{exactly} what we needed.  To understand his program, recall these two facts about \(\zeta\):
\begin{enumerate}
    \item Except for a real \index{zeta function@\(\zeta\)--function!Euler factor}Euler factor, \(\zeta\) is basically the \index{Mellin transform}Mellin transform of the measure \(\frac{\dx}{\mathrm e^x - 1}\) (i.e., its sequence of moments): \[\zeta(s) = \frac{1}{\Gamma(s)} \int_0^\infty x^{s-1} \frac{\dx}{\mathrm e^x - 1}.\]
    \item For any \(k \in \Z_{> 0}\), \(\zeta(1 - k) = -B_k / k\), where \(\frac{t}{\mathrm e^t - 1} = \sum_{k=0}^\infty B_k \frac{t^k}{k!}\).
\end{enumerate}
Mazur's idea was to build a \index{zeta function@\(\zeta\)--function!p adic@\(p\)--adic} \(p\)--adic \(\zeta\)--function by investigating similar \(p\)--adic integrals, beginning with certain finitary approximations to this one.  To begin, a Bernoulli polynomial\index{Bernoulli!polynomial} for \(k \in \Z_{>0}\) is \[\sum_{k=0}^\infty B_k(x) \frac{t^k}{k!} = \frac{t \mathrm e^{tx}}{\mathrm e^t - 1}.\]  These polynomials beget Bernoulli distributions\index{Bernoulli!distribution} according to the rule
\begin{align*}
\Z/p^n\Z & \xrightarrow{E_k} \Q \subseteq \Q_p \\
x \in [0, p^n) & \mapsto k^{-1} p^{n(k-1)} B_k(x p^{-n}).
\end{align*}
A distribution in general is a function on \(\Z_p\) such that its value at any node in the \(p\)--adic tree is equal to the sum of the values of its immediate children, and the \(p\)--adic integral of a locally constant function with respect to such a distribution is defined by their convolution.  For example, the constant function \(1\) factors through \(\Z/p\), hence \[\int_{\Z_p} dE_k = \overset{\text{non-obvious}}{\overbrace{\frac{1}{k} \sum_{a=0}^{p-1} B_k\left(\frac{a}{p}\right) = \frac{B_k(0)}{k}}} = \frac{B_k}{k}.\]

However, this distribution is not a \emph{measure}, in the sense that it is not bounded and hence does not extend to a functional on all continuous functions (rather than just locally constant ones).  The standard fix for this is called \index{regularization}\index{Bernoulli!measure}\textit{regularization}: pick \(c \in \Z\) with \(p \nmid c\), and set \(E_{k,c}(x) = E_k(x) - c^kE_k(c^{-1}x)\).  This is a measure, and for \(k \ge 1\) it has total volume given by \[\int_{\Z_p} \mathrm dE_{k,c} = \int_{\Z_p} \mathrm dE_k - c^k \int_{\Z_p} \mathrm dE_k(c^{-1}x) = \frac{B_k}{k}(1 - c^k).\]

These measures interrelate: \(E_{k, c} = x^{k-1} E_{1, c}\), and hence the single measure \(E_{1, c}\) has all of these values as moments.  We would like to perform \(p\)--adic interpolation\index{p adic interpolation@\(p\)--adic interpolation} in \(k\) to remove the restriction \(k \ge 1\), but this is not naively possible: if \(k = 0\), say, then we naively have \(E_{0, c} = x^{-1} E_{1, c}\), which will not make sense whenever \(x \in p\Z_p\).  This is most easily solved by restricting \(x\) to lie in \(\Z_p^\times\), which has a predictable effect for \(k \in \Z_{> 0}\):
\begin{align*}
\int_{\Z_p^\times} x^{k-1} \mathrm dE_{1,c} & = \int_{\Z_p} x^{k-1} \mathrm dE_{1,c} - \int_{p\Z_p} x^{k-1} \mathrm dE_{1, c} \\
& = \int_{\Z_p} x^{k-1} \mathrm dE_{1,c} - p^{k-1} \int_{\Z_p} x^{k-1} \mathrm dE_{1, c} \\
& = \frac{B_k}{k}(1 - c^k)(1 - p^{k-1}).
\end{align*}
Hence, the Mellin transform of the measure \(dE_{1,c}\) on \(\Z_p^\times\) gives a sort of \(p\)--adic interpolation of the \(\zeta\)--function.

It also has \emph{exactly} the properties we need to guarantee the existence of an \(E_\infty\)--orientation \(M\Spin \to KO\).  It is remarkable that the three factors in \[\int_{\Z_p^\times} x^{k-1} \mathrm d E_{1, c} = \frac{B_k}{k} (1 - c^k)(1 - p^{k-1})\] have discernable provenances in the two fields.  In stable homotopy theory these arise respectively in the characteristic series of the orientation \(MU \to KU\), in the finite Adams resolution for the \(K(1)\)--local sphere, and in the Rezk logarithm.  In \(p\)--adic analytic number theory, they arise as the special values of the \(\zeta\)--function, the regularization to make it a measure, and the restriction to perform \(p\)--adic interpolation.  It is completely mysterious how or if these operations correspond.


\subsubsection{Footnotes on the \(\tmf\) case}

The case of the orientation \(M\String \to \tmf\) has all of the same trappings, but its order of complexity is \((-)^{3/2}\) of the above case, essentially because the height \(1\) chromatic fracture \emph{square} gets replaced by the height \(2\) chromatic fracture \emph{cube}.  (There is also the issue of the more complicated coefficient ring \(\tmf_*\) over \(KO_*\).)  Many of the steps remain the same:
\begin{enumerate}
    \item Begin with a rational orientation, which is basically the Witten genus valued in holomorphic expansions of modular forms.
    \item Analyze the homotopy type of \(\widehat L_1 \tmf\) and compare it to that of \(KO\).  This lets us use another universal coefficient theorem to lift our description of \(KO^* KO\) as \(KO^*\)--valued measures to \((\widehat L_1 \tmf)^* KO\) as \(\widehat L_1 \tmf^*\)--valued measures.
    \item The homotopy type of \(\widehat L_2 \tmf\) is ``naively irrelevant'' in the chromatic fracture square: maps \(b\spin \to \widehat L_2 \tmf\) factor through \(\widehat L_2 b\spin = \widehat L_2 KO_p = 0\).
    \item However, the logarithm's presence in the chromatic fracture square \[\widehat L_1 \tmf \to \widehat L_1 \widehat L_2 \tmf\] has a real effect that must be understood.  This is not easy: the higher height logarithm is not so accessible, and in general it is best cast in the language of \(p\)--divisible groups.\footnote{Behrens has claimed, but has not yet put into print, that the transchromatic logarithms are described by an analogue of Rezk's formulas for the logarithm at height \(n\)~\cite[Subsections 1.10 and 1.12]{RezkLogarithm}, where the collection of subgroups appearing in the formula are replaced by those subgroups of a certain \(p\)--divisible group (arising from a base-changed formal group) which have no interaction with the \'etale component.}  In the specific case of \(\tmf\), it requires a real understanding of its theory of power operations, which must be assembled out of the discussion of power operations for \(E\)--theories given above.
    \item You also have to calculate the Miller invariant associated to \(\tmf\).  In the case of \(\EinftyRings(M\Spin, KO)\), one uses the \(A_\infty\)--orientation \(MU \to KU\), as well as a rational understanding of the maps \(\pi_* BU \to \pi_* BO\) and \(\pi_* KO \to \pi_* KU\), and one must replace each of these ingredients with \(\tmf\) analogues.  The main point is that there are very few modular forms whose constant term is a given Bernoulli number\index{Bernoulli!number}.  There is an alternative approach, along the lines of Miller's original calculation~\cite{MillerBernoulliNos}, that takes as input a calculation of a certain \(S^1\)--transfer.\footnote{There is, supposedly, a further alternative approach that uses an \(H_\infty\)--orientation and tricks with the Bousfield--Kuhn functor to determine the Miller invariant, but I am unable to reconstruct this argument.}
    \item Finally, you have to ramp up the algebraic part of the calculation by identifying the analogues of the Mazur moments in \(\pi_* \widehat L_1 \tmf\).  These turn out to be normalized \index{Eisenstein series}Eisenstein series.
\end{enumerate}









